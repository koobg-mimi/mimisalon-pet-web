module.exports=[812710,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(529139),e=a.i(50944),f=a.i(695245),g=a.i(159501),h=a.i(699570),i=a.i(591119),j=a.i(429246),k=a.i(870430),l=a.i(750104),m=a.i(30553),n="Progress",[o,p]=(0,l.createContextScope)(n),[q,r]=o(n),s=c.forwardRef((a,c)=>{var d,e;let{__scopeProgress:f,value:g=null,max:h,getValueLabel:i=v,...j}=a;(h||0===h)&&!y(h)&&console.error((d=`${h}`,`Invalid prop \`max\` of value \`${d}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let k=y(h)?h:100;null===g||z(g,k)||console.error((e=`${g}`,`Invalid prop \`value\` of value \`${e}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let l=z(g,k)?g:null,n=x(l)?i(l,k):void 0;return(0,b.jsx)(q,{scope:f,value:l,max:k,children:(0,b.jsx)(m.Primitive.div,{"aria-valuemax":k,"aria-valuemin":0,"aria-valuenow":x(l)?l:void 0,"aria-valuetext":n,role:"progressbar","data-state":w(l,k),"data-value":l??void 0,"data-max":k,...j,ref:c})})});s.displayName=n;var t="ProgressIndicator",u=c.forwardRef((a,c)=>{let{__scopeProgress:d,...e}=a,f=r(t,d);return(0,b.jsx)(m.Primitive.div,{"data-state":w(f.value,f.max),"data-value":f.value??void 0,"data-max":f.max,...e,ref:c})});function v(a,b){return`${Math.round(a/b*100)}%`}function w(a,b){return null==a?"indeterminate":a===b?"complete":"loading"}function x(a){return"number"==typeof a}function y(a){return x(a)&&!isNaN(a)&&a>0}function z(a,b){return x(a)&&!isNaN(a)&&a<=b&&a>=0}u.displayName=t;var A=a.i(368114);function B({className:a,value:c,...d}){return(0,b.jsx)(s,{"data-slot":"progress",className:(0,A.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",a),...d,children:(0,b.jsx)(u,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(c||0)}%)`}})})}var C=a.i(124348),D=a.i(596221),E=a.i(816201),F=a.i(292e3),G=a.i(452495),H=a.i(823292),I=a.i(633508),J=a.i(773320),K=a.i(838632);let L=["image/jpeg","image/png","image/gif","image/webp"];var M=a.i(156757);let N=M.z.object({description:M.z.string().min(10,"문제 설명은 최소 10자 이상이어야 합니다").max(2e3,"문제 설명은 2000자를 초과할 수 없습니다").trim()});M.z.object({description:M.z.string().min(10,"문제 설명은 최소 10자 이상이어야 합니다").max(2e3,"문제 설명은 2000자를 초과할 수 없습니다").trim(),browserInfo:M.z.string(),timestamp:M.z.string(),userId:M.z.string().optional(),userName:M.z.string().optional(),url:M.z.string().optional()}).extend({hasImages:M.z.boolean().optional(),imageCount:M.z.number().min(0).max(5,"최대 5개의 이미지까지 업로드할 수 있습니다").optional()});let O=M.z.object({name:M.z.string(),size:M.z.number().max(0xa00000,"이미지 크기는 10MB를 초과할 수 없습니다"),type:M.z.string().refine(a=>["image/jpeg","image/png","image/gif","image/webp"].includes(a),"지원하지 않는 이미지 형식입니다. JPEG, PNG, GIF, WebP만 업로드 가능합니다")}),P=M.z.object({id:M.z.string(),key:M.z.string(),self:M.z.url(),browseUrl:M.z.url()});function Q({images:a,onImagesChange:d,onRemoveImage:e,disabled:f=!1,maxImages:g=5,maxFileSize:j=0xa00000,className:k}){let[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)([]),p=(0,c.useCallback)(b=>{if(!b||0===b.length)return;let c=Array.from(b);if(a.length+c.length>g)return void o([`최대 ${g}개의 이미지까지 업로드할 수 있습니다`]);let e=function(a){let b=[],c=[];if(a.length>5)return c.push("최대 5개의 이미지까지 업로드할 수 있습니다"),{valid:b,errors:c};for(let d of a)try{O.parse({name:d.name,size:d.size,type:d.type}),b.push(d)}catch(a){a instanceof M.z.ZodError?c.push(`${d.name}: ${a?.message}`):c.push(`${d.name}: 유효하지 않은 파일입니다`)}return{valid:b,errors:c}}(c);e.errors.length>0?o(e.errors):(o([]),d([...a,...e.valid.map(a=>({file:a,url:URL.createObjectURL(a),id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}))]))},[a,g,d]),q=(0,c.useCallback)(a=>{p(a.target.files),a.target.value=""},[p]),r=(0,c.useCallback)(a=>{a.preventDefault(),a.stopPropagation()},[]),s=(0,c.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),m(!0)},[]),t=(0,c.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),m(!1)},[]),u=(0,c.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),m(!1),f||p(a.dataTransfer.files)},[f,p]),v=(0,c.useCallback)(b=>{let c=a.find(a=>a.id===b);c&&URL.revokeObjectURL(c.url),e(b)},[a,e]),w=a=>{if(0===a)return"0 B";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(1))+" "+["B","KB","MB","GB"][b]},x=a.length<g;return(0,b.jsxs)("div",{className:(0,A.cn)("space-y-4",k),children:[x&&(0,b.jsxs)("div",{className:(0,A.cn)("relative rounded-lg border-2 border-dashed p-6 transition-colors",l?"border-primary bg-primary/5":"border-gray-300 hover:border-gray-400",f&&"cursor-not-allowed opacity-50"),onDragEnter:s,onDragLeave:t,onDragOver:r,onDrop:u,children:[(0,b.jsx)("input",{type:"file",id:"error-report-images",multiple:!0,accept:L.join(","),onChange:q,disabled:f,className:"absolute inset-0 h-full w-full cursor-pointer opacity-0 disabled:cursor-not-allowed"}),(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,b.jsx)(J.Upload,{className:"mb-4 h-10 w-10 text-gray-400"}),(0,b.jsxs)("p",{className:"mb-2 text-sm text-gray-600",children:[(0,b.jsx)("span",{className:"font-medium",children:"클릭하여 업로드"})," 또는 파일을 드래그하세요"]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["JPG, PNG, GIF, WebP (최대 ",w(j),")"]}),(0,b.jsxs)("p",{className:"mt-1 text-xs text-gray-500",children:[a.length,"/",g,"개 이미지"]})]})]}),n.length>0&&(0,b.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 p-3",children:(0,b.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,b.jsx)(F.AlertCircle,{className:"mt-0.5 h-4 w-4 flex-shrink-0 text-red-500"}),(0,b.jsx)("div",{className:"space-y-1",children:n.map((a,c)=>(0,b.jsx)("p",{className:"text-sm text-red-700",children:a},c))})]})}),a.length>0&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("h4",{className:"text-sm font-medium text-gray-900",children:["첨부된 이미지 (",a.length,")"]}),!x&&(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["최대 ",g,"개까지 업로드 가능"]})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4",children:a.map(a=>(0,b.jsx)(i.Card,{className:"group relative",children:(0,b.jsx)(i.CardContent,{className:"p-2",children:(0,b.jsxs)("div",{className:"relative aspect-square overflow-hidden rounded-md bg-gray-100",children:[(0,b.jsx)("img",{src:a.url,alt:a.file.name,className:"h-full w-full object-cover",onLoad:()=>{},onError:()=>{console.error("Failed to load image preview:",a.file.name)}}),(0,b.jsx)(h.Button,{type:"button",variant:"destructive",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0 opacity-0 transition-opacity group-hover:opacity-100",onClick:()=>v(a.id),disabled:f,children:(0,b.jsx)(I.X,{className:"h-3 w-3"})}),(0,b.jsxs)("div",{className:"absolute right-0 bottom-0 left-0 bg-black/70 p-1 text-white opacity-0 transition-opacity group-hover:opacity-100",children:[(0,b.jsx)("p",{className:"truncate text-xs",title:a.file.name,children:a.file.name}),(0,b.jsx)("p",{className:"text-xs",children:w(a.file.size)})]})]})})},a.id))})]}),0===a.length&&!x&&(0,b.jsxs)("div",{className:"py-8 text-center text-gray-500",children:[(0,b.jsx)(K.Image,{className:"mx-auto mb-3 h-12 w-12 text-gray-300"}),(0,b.jsx)("p",{className:"text-sm",children:"이미지가 첨부되지 않았습니다"})]}),(0,b.jsxs)("div",{className:"space-y-1 text-xs text-gray-500",children:[(0,b.jsx)("p",{children:"• 스크린샷이나 에러 화면 캡처를 첨부하면 문제 해결에 도움이 됩니다"}),(0,b.jsx)("p",{children:"• 개인정보가 포함된 이미지는 업로드하지 마세요"}),(0,b.jsxs)("p",{children:["• 각 이미지는 최대 ",w(j),"까지 업로드 가능합니다"]})]})]})}function R({onSubmit:a,initialData:d,disabled:e=!1,className:l}){let[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)({isUploading:!1,progress:0,stage:"idle"}),[q,r]=(0,c.useState)(null),{register:s,handleSubmit:t,setValue:u,reset:v,watch:w,formState:{errors:x}}=(0,f.useForm)({resolver:(0,g.zodResolver)(N),mode:"onChange",defaultValues:{description:d?.description||""}}),y=w("description"),z=!y||y.length<10||e||o.isUploading;console.log("Form state:",{description:y?.length||0,disabled:e,isUploading:o.isUploading,isButtonDisabled:z,errors:x});let I=(0,c.useCallback)(a=>{n(a)},[]),J=(0,c.useCallback)(a=>{n(b=>b.filter(b=>b.id!==a))},[]),K=async b=>{if(!o.isUploading)try{p({isUploading:!0,progress:20,stage:"creating-issue",message:"Jira 이슈를 생성하는 중..."});let c=new FormData;c.append("description",b.description),c.append("browserInfo","Unknown"),c.append("timestamp",new Date().toISOString()),c.append("url",window.location.href),m.forEach(a=>{c.append("images",a.file)}),p({isUploading:!0,progress:m.length>0?60:80,stage:m.length>0?"uploading-images":"completed",message:m.length>0?"이미지를 업로드하는 중...":"완료 중..."});let d=await fetch("/api/error-report",{method:"POST",body:c}),e=await d.json();if(!d.ok)throw Error(e.error||"Failed to submit error report");p({isUploading:!0,progress:90,stage:"completed",message:"완료 중..."}),await new Promise(a=>setTimeout(a,500)),p({isUploading:!1,progress:100,stage:"completed",message:"성공적으로 제출되었습니다!"});let f={success:!0,issue:e.issue,attachmentIds:e.attachmentIds,message:e.message};r(f),H.toast.success("에러 신고가 성공적으로 접수되었습니다!",{description:`이슈 번호: ${e.issue.key}`}),a?.(f)}catch(d){console.error("Error report submission failed:",d);let b=d instanceof Error?d.message:"Unknown error occurred";p({isUploading:!1,progress:0,stage:"error",message:b});let c={success:!1,error:b,message:"에러 신고 제출에 실패했습니다"};r(c),H.toast.error("에러 신고 제출에 실패했습니다",{description:b}),a?.(c)}},L=(0,c.useCallback)(()=>{r(null),p({isUploading:!1,progress:0,stage:"idle"})},[]);return q?.success?(0,b.jsx)(i.Card,{className:l,children:(0,b.jsxs)(i.CardContent,{className:"p-8 text-center",children:[(0,b.jsx)(E.CheckCircle,{className:"mx-auto mb-4 h-16 w-16 text-green-500"}),(0,b.jsx)("h3",{className:"mb-2 text-xl font-semibold text-green-700",children:"에러 신고가 접수되었습니다"}),(0,b.jsx)("p",{className:"mb-4 text-gray-600",children:"귀하의 신고가 성공적으로 처리되었습니다. 빠른 시일 내에 검토하겠습니다."}),(0,b.jsx)("div",{className:"mb-6 rounded-lg border border-green-200 bg-green-50 p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-sm text-green-700",children:[(0,b.jsx)("span",{className:"font-medium",children:"이슈 번호:"}),(0,b.jsx)("span",{className:"rounded bg-green-100 px-2 py-1 font-mono",children:q.issue?.key})]})}),(0,b.jsxs)("div",{className:"flex flex-col justify-center gap-3 sm:flex-row",children:[(0,b.jsxs)(h.Button,{variant:"outline",onClick:()=>window.open(q.issue?.browseUrl,"_blank"),className:"flex items-center gap-2",children:[(0,b.jsx)(G.ExternalLink,{className:"h-4 w-4"}),"Jira에서 보기"]}),(0,b.jsx)(h.Button,{onClick:()=>window.location.reload(),children:"새 신고 작성"})]})]})}):(0,b.jsx)("form",{onSubmit:t(K),className:l,children:(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)(i.CardTitle,{children:"에러 신고"})}),(0,b.jsxs)(i.CardContent,{className:"space-y-6",children:[o.isUploading&&(0,b.jsxs)(C.Alert,{children:[(0,b.jsx)(D.Loader2,{className:"h-4 w-4 animate-spin"}),(0,b.jsx)(C.AlertDescription,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{children:o.message}),(0,b.jsx)(B,{value:o.progress,className:"w-full"})]})})]}),q?.success===!1&&(0,b.jsxs)(C.Alert,{variant:"destructive",children:[(0,b.jsx)(F.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(C.AlertDescription,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{children:q.message}),(0,b.jsx)(h.Button,{type:"button",variant:"outline",size:"sm",onClick:L,children:"다시 시도"})]})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"description",className:"text-sm font-medium",children:"문제 설명 *"}),(0,b.jsx)(j.Textarea,{id:"description",...s("description"),placeholder:"발생한 문제를 자세히 설명해주세요. 어떤 상황에서 발생했는지, 어떤 에러 메시지가 나타났는지 등을 포함해주세요.",rows:6,disabled:e||o.isUploading,className:(0,A.cn)(x.description&&"border-red-500")}),x.description&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:x.description.message}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"문제를 재현하는 방법이나 예상했던 동작과 실제 동작의 차이를 포함해서 작성해주세요."}),(0,b.jsxs)("p",{className:`text-xs ${y&&y.length>=10?"text-green-600":"text-gray-400"}`,children:[y?y.length:0," / 2000자"]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{className:"text-sm font-medium",children:"스크린샷 (선택사항)"}),(0,b.jsx)(Q,{images:m,onImagesChange:I,onRemoveImage:J,disabled:e||o.isUploading})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,b.jsx)(h.Button,{type:"button",variant:"outline",onClick:()=>{v(),n([])},disabled:e||o.isUploading,children:"초기화"}),(0,b.jsx)(h.Button,{type:"submit",disabled:z,className:"min-w-[120px]",children:o.isUploading?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(D.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"제출 중..."]}):"에러 신고 제출"})]}),(0,b.jsxs)("div",{className:"border-t pt-4 text-xs text-gray-500",children:[(0,b.jsx)("p",{children:"• 에러 신고는 개발팀에서 검토 후 처리됩니다"}),(0,b.jsx)("p",{children:"• 개인정보는 포함하지 마시고, 문제 해결에 필요한 정보만 작성해주세요"}),(0,b.jsx)("p",{children:"• 스크린샷을 첨부하면 문제 파악에 큰 도움이 됩니다"})]})]})]})})}M.z.object({success:M.z.boolean(),issue:P,attachmentIds:M.z.array(M.z.string()),message:M.z.string()}),M.z.object({success:M.z.literal(!1),error:M.z.string(),details:M.z.array(M.z.object({field:M.z.string(),message:M.z.string()})).optional()});var S=a.i(73570),T=a.i(681010);function U(){let{data:a,isPending:f}=(0,d.useSession)(),g=(0,e.useRouter)(),[i,j]=(0,c.useState)(!0);return((0,c.useEffect)(()=>{f||j(!1)},[f]),i)?(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"mx-auto h-8 w-8 animate-spin rounded-full border-b-2 border-gray-900"}),(0,b.jsx)("p",{className:"mt-2 text-gray-600",children:"로딩 중..."})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,b.jsxs)("div",{className:"mx-auto max-w-2xl px-4 sm:px-6 lg:px-8",children:[(0,b.jsxs)("div",{className:"mb-6 text-center",children:[(0,b.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,b.jsx)("div",{}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"에러 신고"}),(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:()=>g.push("/"),className:"flex items-center gap-2",children:[(0,b.jsx)(T.Home,{className:"h-4 w-4"}),"홈으로"]})]}),(0,b.jsx)("p",{className:"text-gray-600",children:"문제가 발생했나요? 아래에 설명과 스크린샷을 첨부해서 알려주세요."})]}),(0,b.jsxs)(C.Alert,{className:"mb-6",children:[(0,b.jsx)(S.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsxs)(C.AlertDescription,{children:[(0,b.jsx)("strong",{children:"참고:"})," 개인정보는 포함하지 마시고, 스크린샷을 첨부하면 문제 해결에 도움이 됩니다."]})]}),(0,b.jsx)(R,{onSubmit:()=>{console.log("Error report submitted:")},className:"mb-6"})]})})}a.s(["default",()=>U],812710)}];

//# sourceMappingURL=src_app_error-report_page_tsx_df8c3f4e._.js.map