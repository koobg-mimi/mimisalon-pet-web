module.exports=[932489,391748,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(524660),e=a.i(854251),f=a.i(254688),g=a.i(390844),h=a.i(699570),i=a.i(786304),j=a.i(866718),k=a.i(870430),l=a.i(205138),m=a.i(529139),n=a.i(823292),o=a.i(368114);function p({variant:a="card",className:p,onSuccess:q}){let{phoneNumber:r,phoneNumberVerified:s,isLoading:t,sendOtp:u,verifyAndUpdate:v}=function(){let{data:a,isPending:b}=(0,m.useSession)(),[d,e]=(0,c.useState)(!1);if(!a)throw Error("usePhoneUpdate must be used within a SessionProvider");let f=a.user,g=f.phoneNumber||null,h=f.phoneNumberVerified||!1,i=f?.role;return{phoneNumber:g,phoneNumberVerified:h,isLoading:b||d,sendOtp:(0,c.useCallback)(async a=>{if(!a)return n.toast.error("ì „í™”ë²ˆí˜¸ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”."),!1;if(!/^\+[1-9]\d{1,14}$/.test(a))return n.toast.error("ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (ì˜ˆ: +821012345678)"),!1;e(!0);try{return console.log("ðŸ“± Sending SMS OTP to:",a),await m.authClient.phoneNumber.sendOtp({phoneNumber:a}),console.log("âœ… SMS OTP sent successfully"),n.toast.success("ì¸ì¦ ì½”ë“œê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."),!0}catch(a){return a instanceof Error?(console.error("âŒ Failed to send SMS OTP:",a),n.toast.error(a?.message||"ì¸ì¦ ì½”ë“œ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")):console.error("âŒ Unknown error sending SMS OTP:",a),!1}finally{e(!1)}},[]),verifyAndUpdate:(0,c.useCallback)(async(a,b)=>{if(!a||!b)return n.toast.error("ì „í™”ë²ˆí˜¸ì™€ ì¸ì¦ ì½”ë“œë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”."),!1;if(6!==b.length)return n.toast.error("ì¸ì¦ ì½”ë“œëŠ” 6ìžë¦¬ìž…ë‹ˆë‹¤."),!1;e(!0);try{console.log("ðŸ” Verifying SMS OTP:",{phoneNumber:a,code:b});let c=await m.authClient.phoneNumber.verify({phoneNumber:a,code:b,updatePhoneNumber:!0});if(c.error)return console.error("âŒ OTP verification failed:",c.error),n.toast.error(c.error.message||"ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),!1;return console.log("âœ… Phone number verified and updated successfully"),n.toast.success("ì „í™”ë²ˆí˜¸ê°€ ì¸ì¦ë˜ì—ˆìŠµë‹ˆë‹¤."),window.location.reload(),!0}catch(a){return console.error("âŒ Phone verification error:",a),n.toast.error(a?.message||"ì¸ì¦ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),!1}finally{e(!1)}},[]),userRole:i}}(),[w,x]=(0,c.useState)("status"),[y,z]=(0,c.useState)(r||""),[A,B]=(0,c.useState)(""),C=async()=>{await u(y)&&x("verify")},D=async()=>{await v(y,A)&&(x("status"),z(""),B(""),q?.())};if("status"===w)return r?s?(0,b.jsxs)("div",{className:(0,o.cn)("flex items-center space-x-3 rounded-lg border border-green-200 bg-green-50 p-4",p),children:[(0,b.jsx)(e.CheckCircleIcon,{className:"h-5 w-5 text-green-600"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-green-800",children:r||""}),(0,b.jsx)(i.Badge,{variant:"secondary",className:"border-green-200 bg-green-100 text-green-800",children:"ì¸ì¦ ì™„ë£Œ"})]}),(0,b.jsx)("p",{className:"text-xs text-green-600",children:"ì „í™”ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì¸ì¦ë˜ì—ˆìŠµë‹ˆë‹¤"})]}),(0,b.jsx)(h.Button,{size:"sm",variant:"outline",onClick:()=>x("input"),children:"ë³€ê²½"})]}):(0,b.jsx)("div",{className:(0,o.cn)("space-y-3",p),children:(0,b.jsxs)("div",{className:"flex items-center space-x-3 rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:[(0,b.jsx)(d.AlertTriangleIcon,{className:"h-5 w-5 text-yellow-600"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-yellow-800",children:r||""}),(0,b.jsx)(i.Badge,{variant:"secondary",className:"border-yellow-200 bg-yellow-100 text-yellow-800",children:"ì¸ì¦ í•„ìš”"})]}),(0,b.jsx)("p",{className:"text-xs text-yellow-600",children:"ì„œë¹„ìŠ¤ ì´ìš©ì„ ìœ„í•´ ì „í™”ë²ˆí˜¸ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤"})]}),(0,b.jsx)(h.Button,{size:"sm",onClick:()=>{z(r||""),x("input")},children:"ì¸ì¦"})]})}):(0,b.jsxs)("div",{className:(0,o.cn)("bg-muted/50 flex items-center space-x-3 rounded-lg p-4","card"===a&&"border-border border",p),children:[(0,b.jsx)(g.XCircleIcon,{className:"text-muted-foreground h-5 w-5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-muted-foreground text-sm font-medium",children:"ì „í™”ë²ˆí˜¸ê°€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"ì „í™”ë²ˆí˜¸ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”"})]}),(0,b.jsxs)(h.Button,{size:"sm",onClick:()=>x("input"),children:[(0,b.jsx)(f.PhoneIcon,{className:"mr-2 h-4 w-4"}),"ì¶”ê°€"]})]});return"input"===w?(0,b.jsxs)("div",{className:(0,o.cn)("space-y-4 rounded-lg p-4","card"===a&&"border-border bg-card border",p),children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"phone",children:"ì „í™”ë²ˆí˜¸ (E.164 í˜•ì‹)"}),(0,b.jsx)(j.Input,{id:"phone",type:"tel",placeholder:"+821012345678",value:y,onChange:a=>z(a.target.value),disabled:t}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"êµ­ê°€ ì½”ë“œë¥¼ í¬í•¨í•˜ì—¬ ìž…ë ¥í•˜ì„¸ìš” (ì˜ˆ: +82 1012345678)"})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsxs)(h.Button,{onClick:C,disabled:t||!y,className:"flex-1",children:[t?(0,b.jsx)(l.LoadingSpinner,{size:"sm",className:"mr-2"}):(0,b.jsx)(f.PhoneIcon,{className:"mr-2 h-4 w-4"}),"ì¸ì¦ ì½”ë“œ ì „ì†¡"]}),(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>x("status"),disabled:t,children:"ì·¨ì†Œ"})]})]}):(0,b.jsxs)("div",{className:(0,o.cn)("space-y-4 rounded-lg p-4","card"===a&&"border-border bg-card border",p),children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"otp",children:"ì¸ì¦ ì½”ë“œ"}),(0,b.jsx)(j.Input,{id:"otp",type:"text",placeholder:"123456",value:A,onChange:a=>B(a.target.value.replace(/\D/g,"").slice(0,6)),disabled:t,maxLength:6}),(0,b.jsxs)("p",{className:"text-muted-foreground text-xs",children:[y||"","ë¡œ ì „ì†¡ëœ 6ìžë¦¬ ì½”ë“œë¥¼ ìž…ë ¥í•˜ì„¸ìš”"]})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsxs)(h.Button,{onClick:D,disabled:t||6!==A.length,className:"flex-1",children:[t?(0,b.jsx)(l.LoadingSpinner,{size:"sm",className:"mr-2"}):null,"ì¸ì¦ ì™„ë£Œ"]}),(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>{x("input"),B("")},disabled:t,children:"ë‹¤ì‹œ ìž…ë ¥"})]}),(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:C,disabled:t,className:"w-full",children:"ì¸ì¦ ì½”ë“œ ìž¬ì „ì†¡"})]})}a.s(["PhoneUpdateForm",()=>p],932489);var q=a.i(695245),r=a.i(159501),s=a.i(156757),t=a.i(177156),u=a.i(141379),v=a.i(596221),w=a.i(252523);function x({password:a,className:d}){let e=c.useMemo(()=>a?(0,w.calculatePasswordStrength)(a):{score:0,level:"weak",feedback:[]},[a]);if(!a)return null;let f={weak:{label:"ì•½í•¨",color:"bg-destructive",textColor:"text-destructive",progress:25},medium:{label:"ë³´í†µ",color:"bg-yellow-500",textColor:"text-yellow-600 dark:text-yellow-500",progress:50},strong:{label:"ê°•í•¨",color:"bg-green-500",textColor:"text-green-600 dark:text-green-500",progress:75},"very-strong":{label:"ë§¤ìš° ê°•í•¨",color:"bg-blue-500",textColor:"text-blue-600 dark:text-blue-500",progress:100}}[e.level];return(0,b.jsxs)("div",{className:(0,o.cn)("space-y-2",d),children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"ë¹„ë°€ë²ˆí˜¸ ê°•ë„"}),(0,b.jsx)("span",{className:(0,o.cn)("font-medium",f.textColor),children:f.label})]}),(0,b.jsx)("div",{className:"bg-secondary relative h-1.5 w-full overflow-hidden rounded-full",children:(0,b.jsx)("div",{className:(0,o.cn)("h-full transition-all duration-300",f.color),style:{width:`${f.progress}%`}})})]}),e.feedback.length>0&&(0,b.jsx)("ul",{className:"text-muted-foreground space-y-0.5 text-xs",children:e.feedback.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-start gap-1.5",children:[(0,b.jsx)("span",{className:"mt-0.5",children:"â€¢"}),(0,b.jsx)("span",{children:a})]},c))})]})}let y=s.z.object({currentPassword:s.z.string().min(1,"í˜„ìž¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”"),newPassword:w.enhancedPasswordSchema,confirmPassword:s.z.string().min(1,"ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”")}).refine(a=>a.newPassword===a.confirmPassword,{message:"ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤",path:["confirmPassword"]}).refine(a=>a.currentPassword!==a.newPassword,{message:"ìƒˆ ë¹„ë°€ë²ˆí˜¸ëŠ” í˜„ìž¬ ë¹„ë°€ë²ˆí˜¸ì™€ ë‹¬ë¼ì•¼ í•©ë‹ˆë‹¤",path:["newPassword"]});function z({onSuccess:a,onCancel:d}){let[e,f]=c.useState(!1),[g,i]=c.useState(!1),[l,o]=c.useState(!1),{register:p,handleSubmit:s,watch:w,reset:z,formState:{errors:A,isSubmitting:B}}=(0,q.useForm)({resolver:(0,r.zodResolver)(y),mode:"onChange"}),C=w("newPassword",""),D=async b=>{try{let{error:c}=await m.authClient.changePassword({currentPassword:b.currentPassword,newPassword:b.newPassword,revokeOtherSessions:!0});if(c)return void(c.message?.includes("current password")?n.toast.error("í˜„ìž¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤"):c.message?.includes("same")?n.toast.error("ìƒˆ ë¹„ë°€ë²ˆí˜¸ëŠ” í˜„ìž¬ ë¹„ë°€ë²ˆí˜¸ì™€ ë‹¬ë¼ì•¼ í•©ë‹ˆë‹¤"):n.toast.error(c.message||"ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"));n.toast.success("ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤",{description:"ë³´ì•ˆì„ ìœ„í•´ ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ìžë™ ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤"}),z(),a?.()}catch(a){console.error("Password change error:",a),n.toast.error("ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤")}};return(0,b.jsxs)("form",{onSubmit:s(D),className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"currentPassword",children:"í˜„ìž¬ ë¹„ë°€ë²ˆí˜¸"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(j.Input,{id:"currentPassword",type:e?"text":"password",autoComplete:"current-password",placeholder:"í˜„ìž¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”",...p("currentPassword"),"aria-invalid":!!A.currentPassword,className:"pr-10"}),(0,b.jsx)("button",{type:"button",onClick:()=>f(!e),className:"text-muted-foreground hover:text-foreground absolute top-1/2 right-3 -translate-y-1/2 transition-colors","aria-label":e?"ë¹„ë°€ë²ˆí˜¸ ìˆ¨ê¸°ê¸°":"ë¹„ë°€ë²ˆí˜¸ ë³´ê¸°",children:e?(0,b.jsx)(u.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(t.Eye,{className:"h-4 w-4"})})]}),A.currentPassword&&(0,b.jsx)("p",{className:"text-destructive text-sm",children:A.currentPassword.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"newPassword",children:"ìƒˆ ë¹„ë°€ë²ˆí˜¸"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(j.Input,{id:"newPassword",type:g?"text":"password",autoComplete:"new-password",placeholder:"ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”",...p("newPassword"),"aria-invalid":!!A.newPassword,className:"pr-10"}),(0,b.jsx)("button",{type:"button",onClick:()=>i(!g),className:"text-muted-foreground hover:text-foreground absolute top-1/2 right-3 -translate-y-1/2 transition-colors","aria-label":g?"ë¹„ë°€ë²ˆí˜¸ ìˆ¨ê¸°ê¸°":"ë¹„ë°€ë²ˆí˜¸ ë³´ê¸°",children:g?(0,b.jsx)(u.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(t.Eye,{className:"h-4 w-4"})})]}),A.newPassword&&(0,b.jsx)("p",{className:"text-destructive text-sm",children:A.newPassword.message}),C&&(0,b.jsx)(x,{password:C})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"confirmPassword",children:"ë¹„ë°€ë²ˆí˜¸ í™•ì¸"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(j.Input,{id:"confirmPassword",type:l?"text":"password",autoComplete:"new-password",placeholder:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ìž…ë ¥í•˜ì„¸ìš”",...p("confirmPassword"),"aria-invalid":!!A.confirmPassword,className:"pr-10"}),(0,b.jsx)("button",{type:"button",onClick:()=>o(!l),className:"text-muted-foreground hover:text-foreground absolute top-1/2 right-3 -translate-y-1/2 transition-colors","aria-label":l?"ë¹„ë°€ë²ˆí˜¸ ìˆ¨ê¸°ê¸°":"ë¹„ë°€ë²ˆí˜¸ ë³´ê¸°",children:l?(0,b.jsx)(u.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(t.Eye,{className:"h-4 w-4"})})]}),A.confirmPassword&&(0,b.jsx)("p",{className:"text-destructive text-sm",children:A.confirmPassword.message})]}),(0,b.jsx)("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-3 dark:border-amber-900/50 dark:bg-amber-950/20",children:(0,b.jsx)("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:"ðŸ”’ ë³´ì•ˆì„ ìœ„í•´ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œ ë‹¤ë¥¸ ëª¨ë“  ê¸°ê¸°ì—ì„œ ìžë™ìœ¼ë¡œ ë¡œê·¸ì•„ì›ƒë©ë‹ˆë‹¤."})}),(0,b.jsxs)("div",{className:"flex gap-2 pt-2",children:[d&&(0,b.jsx)(h.Button,{type:"button",variant:"outline",onClick:d,disabled:B,children:"ì·¨ì†Œ"}),(0,b.jsxs)(h.Button,{type:"submit",disabled:B,className:"flex-1",children:[B&&(0,b.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),B?"ë³€ê²½ ì¤‘...":"ë¹„ë°€ë²ˆí˜¸ ë³€ê²½"]})]})]})}a.s(["ChangePasswordForm",()=>z],391748)}];

//# sourceMappingURL=src_components_auth_phone-update-form_tsx_862061f1._.js.map