(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,948402,e=>{"use strict";var t=e.i(843476),s=e.i(578938),a=e.i(613846),r=e.i(271645),i=e.i(519455),l=e.i(93814),n=e.i(522706),c=e.i(401851),o=e.i(116550),d=e.i(87316),m=e.i(968553),h=e.i(299339),x=e.i(144988),g=e.i(592930),u=e.i(790597);let p=(0,e.i(475254).default)("syringe",[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]]);var j=e.i(727612),f=e.i(487486),v=e.i(515288),N=e.i(868499),y=e.i(657688);function b({pet:e,onEdit:s,onDelete:a}){let[l,n]=(0,r.useState)(!1),b=((e,t)=>{if(e){let s;if("string"==typeof e){if(isNaN((s=new Date(e)).getTime()))return t}else s=e;let a=new Date,r=a.getFullYear()-s.getFullYear(),i=a.getMonth()-s.getMonth();return i<0||0===i&&a.getDate()<s.getDate()?r-1:r}return t})(e.birthDate,e.age),w=e.images?.find(e=>e.isPrimary)||e.images?.[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(v.Card,{className:"overflow-hidden transition-shadow hover:shadow-lg",children:[(0,t.jsxs)("div",{className:"bg-muted relative h-48",children:[w?(0,t.jsx)(y.default,{src:w.url,alt:e.name,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}):(0,t.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:["DOG"===e.type?(0,t.jsx)(x.Dog,{className:"text-muted-foreground/50 mx-auto h-16 w-16"}):(0,t.jsx)(h.Cat,{className:"text-muted-foreground/50 mx-auto h-16 w-16"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-xs",children:"ì‚¬ì§„ ì—†ìŒ"})]})}),e.images&&e.images.length>0&&(0,t.jsxs)("div",{className:"absolute right-2 bottom-2 flex items-center gap-1 rounded-md bg-black/70 px-2 py-1 text-xs text-white",children:[(0,t.jsx)(m.Camera,{className:"h-3 w-3"}),e.images.length]}),(0,t.jsx)("div",{className:"absolute top-2 right-2",children:(e=>{switch(e){case"UP_TO_DATE":return(0,t.jsx)(f.Badge,{className:"bg-green-500",children:"ì ‘ì¢… ì™„ë£Œ"});case"OVERDUE":return(0,t.jsx)(f.Badge,{variant:"destructive",children:"ì ‘ì¢… ì§€ì—°"});case"PARTIAL":return(0,t.jsx)(f.Badge,{variant:"secondary",children:"ë¶€ë¶„ ì ‘ì¢…"});default:return(0,t.jsx)(f.Badge,{variant:"outline",children:"ë¯¸í™•ì¸"})}})(e.vaccinationStatus)})]}),(0,t.jsx)(v.CardHeader,{className:"pb-3",children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-primary/10 flex h-10 w-10 items-center justify-center rounded-full",children:"DOG"===e.type?(0,t.jsx)(x.Dog,{className:"text-primary h-5 w-5"}):(0,t.jsx)(h.Cat,{className:"text-primary h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:e.name}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:e.breed?.name||("DOG"===e.type?"ë¯¹ìŠ¤ê²¬":"ë¯¹ìŠ¤ë¬˜")})]})]})})}),(0,t.jsxs)(v.CardContent,{className:"space-y-3 pt-0",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:["DOG"===e.type&&e.breed?.name&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Heart,{className:"text-muted-foreground h-4 w-4"}),(0,t.jsx)("span",{children:e.breed.name})]}),"CAT"===e.type&&e.hairType&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Heart,{className:"text-muted-foreground h-4 w-4"}),(0,t.jsx)("span",{children:(e=>{switch(e){case"SHORT_HAIR":return"ë‹¨ëª¨";case"LONG_HAIR":return"ì¥ëª¨";default:return null}})(e.hairType)})]}),e.gender&&"UNKNOWN"!==e.gender&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ì„±ë³„:"}),(0,t.jsx)("span",{children:"MALE"===e.gender?"ë‚¨ì":"ì—¬ì"})]}),null!=b&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Calendar,{className:"text-muted-foreground h-4 w-4"}),(0,t.jsxs)("span",{children:[b,"ì‚´"]})]}),e.weight&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ì²´ì¤‘:"}),(0,t.jsxs)("span",{children:[e.weight,"kg"]})]})]}),e.specialNeeds&&(0,t.jsxs)("div",{className:"bg-muted/50 rounded-lg p-3",children:[(0,t.jsx)("p",{className:"mb-1 text-xs font-medium",children:"íŠ¹ì´ì‚¬í•­"}),(0,t.jsx)("p",{className:"text-muted-foreground line-clamp-2 text-xs",children:e.specialNeeds})]}),e.vaccinationDate&&(0,t.jsxs)("div",{className:"text-muted-foreground flex items-center gap-2 text-xs",children:[(0,t.jsx)(p,{className:"h-3 w-3"}),(0,t.jsxs)("span",{children:["ìµœê·¼ ì ‘ì¢…: ",(0,c.format)(e.vaccinationDate,"yyyy-MM-dd",{locale:o.ko})]})]})]}),(0,t.jsxs)(v.CardFooter,{className:"flex flex-row gap-2 pt-3",children:[(0,t.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:()=>s(e),className:"flex-1",children:[(0,t.jsx)(g.Edit2,{className:"mr-2 h-4 w-4"}),"ìˆ˜ì •"]}),(0,t.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:()=>{n(!0)},className:"text-destructive hover:text-destructive flex-1",children:[(0,t.jsx)(j.Trash2,{className:"mr-2 h-4 w-4"}),"ì‚­ì œ"]})]})]}),(0,t.jsx)(N.AlertDialog,{open:l,onOpenChange:n,children:(0,t.jsxs)(N.AlertDialogContent,{children:[(0,t.jsxs)(N.AlertDialogHeader,{children:[(0,t.jsx)(N.AlertDialogTitle,{children:"ë°˜ë ¤ë™ë¬¼ ì‚­ì œ"}),(0,t.jsxs)(N.AlertDialogDescription,{children:[e.name,"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]})]}),(0,t.jsxs)(N.AlertDialogFooter,{children:[(0,t.jsx)(N.AlertDialogCancel,{children:"ì·¨ì†Œ"}),(0,t.jsx)(N.AlertDialogAction,{onClick:()=>{a(e.id),n(!1)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"ì‚­ì œ"})]})]})})]})}var w=e.i(473708),S=e.i(664659),D=e.i(655900),C=e.i(793479),k=e.i(110204),T=e.i(624687),F=e.i(776639),A=e.i(967489),$=e.i(772436),I=e.i(846696),O=e.i(870273),E=e.i(531278),z=e.i(75505),P=e.i(975157);let L=["image/jpeg","image/jpg","image/png","image/webp","image/gif"];function B({images:e=[],onUpload:s,onDelete:a,onSetPrimary:l,maxImages:n=10,isUploading:c=!1,className:o}){let[d,h]=(0,r.useState)(new Set),[x,g]=(0,r.useState)(!1),[u,p]=(0,r.useState)(null),f=(0,r.useRef)(null),v=(0,r.useRef)(null),b=(0,r.useCallback)(async t=>{console.log("Processing files for upload:",{count:t.length,files:t.map(e=>({name:e.name,type:e.type||"unknown",size:e.size,sizeMB:(e.size/1048576).toFixed(2)}))});let a=t.filter(e=>e.type?L.includes(e.type)?!(e.size>0xa00000)||(console.error(`File too large: ${e.name} (${(e.size/1048576).toFixed(2)}MB)`),alert(`${e.name}: íŒŒì¼ì´ ë„ˆë¬´ í½ë‹ˆë‹¤ (${(e.size/1048576).toFixed(2)}MB). ìµœëŒ€ 10MBê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤.`),!1):(console.error(`Invalid file type: ${e.type} for ${e.name}`),alert(`${e.name}: ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤ (${e.type}). JPG, PNG, WebP, GIFë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.`),!1):(console.error(`No file type detected for ${e.name}`),alert(`${e.name}: íŒŒì¼ í˜•ì‹ì„ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.`),!1));console.log(`Valid files after filtering: ${a.length}`);let r=n-e.length;if(r<=0)return void alert(`ìµœëŒ€ ${n}ê°œì˜ ì´ë¯¸ì§€ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤`);let i=a.slice(0,r);if(i.length>0){console.log(`Uploading ${i.length} files...`);try{await s(i)}catch(e){console.error("Upload failed:",e),e instanceof Error&&e.message.includes("Invalid files data")&&alert("íŒŒì¼ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìŠ¤í¬ë¦°ìƒ· íŒŒì¼ì€ ì§ì ‘ ì—…ë¡œë“œí•  ìˆ˜ ì—†ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.")}}else console.log("No files to upload after validation");a.length>i.length&&alert(`${a.length-i.length}ê°œ íŒŒì¼ì´ ì œí•œì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤`)},[e.length,n,s]),S=(0,r.useCallback)(async e=>{let t=e.target.files?Array.from(e.target.files):[];(console.log(`File input selected ${t.length} files`),0===t.length)?console.log("No files selected from input"):(await b(t),f.current&&(f.current.value=""),v.current&&(v.current.value=""))},[b]),D=async()=>{u&&(await a(u),p(null)),g(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,P.cn)("space-y-4",o),children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("p",{className:"text-muted-foreground mb-3 text-sm",children:["JPG, PNG, WebP, GIF (ìµœëŒ€ 10MB) â€¢ ",e.length,"/",n," ì´ë¯¸ì§€"]})}),(0,t.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,t.jsx)(i.Button,{type:"button",variant:"outline",size:"lg",onClick:()=>f.current?.click(),disabled:c||e.length>=n,className:"h-12 max-w-[160px] flex-1",children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.Loader2,{className:"mr-2 h-5 w-5 animate-spin"}),"ì—…ë¡œë“œ ì¤‘..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z.FolderOpen,{className:"mr-2 h-5 w-5"}),"ì´ë¯¸ì§€ ì—´ê¸°"]})}),(0,t.jsxs)(i.Button,{type:"button",variant:"outline",size:"lg",onClick:()=>v.current?.click(),disabled:c||e.length>=n,className:"h-12 max-w-[160px] flex-1",children:[(0,t.jsx)(m.Camera,{className:"mr-2 h-5 w-5"}),"ì¹´ë©”ë¼ ì‚¬ìš©"]})]}),(0,t.jsx)("input",{ref:f,type:"file",multiple:!0,accept:"image/*",onChange:S,className:"hidden",disabled:c||e.length>=n}),(0,t.jsx)("input",{ref:v,type:"file",accept:"image/*",capture:"environment",onChange:S,className:"hidden",disabled:c||e.length>=n})]}),e.length>0&&(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4",children:e.map(e=>(0,t.jsxs)("div",{className:(0,P.cn)("group relative overflow-hidden rounded-lg border",d.has(e.id)?"border-primary ring-primary ring-2":"border-border"),children:[(0,t.jsx)("div",{className:"bg-muted relative aspect-square",children:e.url?(0,t.jsx)(y.default,{src:e.url,alt:e.filename,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw"}):(0,t.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,t.jsx)(w.Image,{className:"text-muted-foreground h-8 w-8"})})}),e.isPrimary&&(0,t.jsxs)("div",{className:"bg-primary text-primary-foreground absolute top-2 left-2 flex items-center gap-1 rounded px-2 py-1 text-xs font-medium",children:[(0,t.jsx)(O.Star,{className:"h-3 w-3 fill-current"}),"ëŒ€í‘œ"]}),(0,t.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center gap-2 bg-black/60 opacity-0 transition-opacity group-hover:opacity-100",children:[!e.isPrimary&&(0,t.jsxs)(i.Button,{type:"button",size:"sm",variant:"secondary",onClick:()=>l(e.id),className:"h-8",children:[(0,t.jsx)(O.Star,{className:"mr-1 h-4 w-4"}),"ëŒ€í‘œ"]}),(0,t.jsx)(i.Button,{type:"button",size:"sm",variant:"destructive",onClick:()=>{p(e.id),g(!0)},className:"h-8",children:(0,t.jsx)(j.Trash2,{className:"h-4 w-4"})})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{var t;let s;return t=e.id,void((s=new Set(d)).has(t)?s.delete(t):s.add(t),h(s))},className:"absolute top-2 right-2 flex h-6 w-6 items-center justify-center rounded-md border-2 border-gray-300 bg-white opacity-0 transition-opacity group-hover:opacity-100",children:d.has(e.id)&&(0,t.jsx)("div",{className:"bg-primary h-3 w-3 rounded-sm"})})]},e.id))}),d.size>0&&(0,t.jsxs)("div",{className:"bg-muted flex items-center gap-2 rounded-lg p-3",children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:[d.size,"ê°œ ì„ íƒë¨"]}),(0,t.jsx)(i.Button,{type:"button",size:"sm",variant:"outline",onClick:()=>h(new Set),children:"ì„ íƒ í•´ì œ"}),(0,t.jsxs)(i.Button,{type:"button",size:"sm",variant:"destructive",onClick:()=>{d.forEach(e=>a(e)),h(new Set)},children:[(0,t.jsx)(j.Trash2,{className:"mr-1 h-4 w-4"}),"ì‚­ì œ"]})]})]}),(0,t.jsx)(N.AlertDialog,{open:x,onOpenChange:g,children:(0,t.jsxs)(N.AlertDialogContent,{children:[(0,t.jsxs)(N.AlertDialogHeader,{children:[(0,t.jsx)(N.AlertDialogTitle,{children:"ì´ë¯¸ì§€ ì‚­ì œ"}),(0,t.jsx)(N.AlertDialogDescription,{children:"ì´ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]}),(0,t.jsxs)(N.AlertDialogFooter,{children:[(0,t.jsx)(N.AlertDialogCancel,{onClick:()=>p(null),children:"ì·¨ì†Œ"}),(0,t.jsx)(N.AlertDialogAction,{onClick:D,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"ì‚­ì œ"})]})]})})]})}function U({isOpen:e,onClose:s,onSave:a,pet:n,mode:c,onImagesUpdated:o}){let[d,m]=(0,r.useState)(!1),[g,u]=(0,r.useState)({}),[p,j]=(0,r.useState)([]),[f,v]=(0,r.useState)([]),[N,b]=(0,r.useState)(!1),[O,E]=(0,r.useState)(!1),[z,P]=(0,r.useState)({name:"",type:"DOG",breedId:"",weight:void 0,age:void 0,birthDate:void 0,gender:void 0,hairType:void 0,specialNeeds:"",vaccinationStatus:"UNKNOWN",vaccinationDate:void 0,termsAcception:!1}),{images:L,isLoading:U,isUploading:M,fetchImages:G,uploadImages:R,deleteImage:H,setPrimaryImage:V}=function(e){let[t,s]=(0,r.useState)([]),[a,i]=(0,r.useState)(!1),[l,n]=(0,r.useState)({}),[c,o]=(0,r.useState)(!1),d=(0,r.useCallback)(async()=>{if(e)try{i(!0);let t=await fetch(`/api/customer/pets/${e}/images`);if(!t.ok)throw Error("Failed to fetch images");let a=await t.json();s(a)}catch(e){console.error("Error fetching pet images:",e),I.toast.error("ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}finally{i(!1)}},[e]),m=(0,r.useCallback)(async t=>{if(!e){console.error("No petId provided for image upload"),I.toast.error("í« ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤. í«ì„ ë¨¼ì € ì €ì¥í•´ì£¼ì„¸ìš”.");return}console.log("Starting pet image upload:",{petId:e,filesCount:t.length,files:t.map(e=>({name:e.name,type:e.type,size:e.size,sizeMB:(e.size/1048576).toFixed(2)}))}),o(!0);let a=[];try{let r=t.filter(e=>e.type&&e.type.startsWith("image/")?!(e.size>0xa00000)||(console.error(`File too large: ${e.name} (${(e.size/1048576).toFixed(2)}MB)`),I.toast.error(`${e.name}: íŒŒì¼ì´ ë„ˆë¬´ í½ë‹ˆë‹¤ (ìµœëŒ€ 10MB)`),a.push(e.name),!1):(console.error(`Invalid file type for ${e.name}: ${e.type||"unknown"}`),I.toast.error(`${e.name}: ì´ë¯¸ì§€ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤`),a.push(e.name),!1));if(0===r.length)return I.toast.error("ì—…ë¡œë“œí•  ìœ íš¨í•œ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤"),[];let i=new FormData;r.forEach(e=>{i.append("files",e)}),console.log(`Uploading ${r.length} files to server...`);let l=await fetch(`/api/customer/pets/${e}/images`,{method:"POST",body:i});if(!l.ok){let e=await l.json().catch(()=>({error:`HTTP ${l.status}: ${l.statusText}`}));throw console.error("Failed to upload images:",e),Error(e.error||"Failed to upload images")}let n=await l.json();console.log("Upload result:",n);let c=n.images||[];return c.length>0&&(s(e=>[...e,...c]),I.toast.success(`${c.length}ê°œ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì™„ë£Œ`)),a.length>0&&I.toast.warning(`ì¼ë¶€ íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨: ${a.join(", ")}`),c}catch(e){return console.error("Failed to upload images:",e),e instanceof Error?e.message.includes("network")||e.message.includes("fetch")?I.toast.error("ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"):I.toast.error(`ì—…ë¡œë“œ ì‹¤íŒ¨: ${e.message}`):I.toast.error("ì´ë¯¸ì§€ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),[]}finally{o(!1),n({})}},[e]),h=(0,r.useCallback)(async t=>{if(e)try{if(!(await fetch(`/api/customer/pets/${e}/images/${t}`,{method:"DELETE"})).ok)throw Error("Failed to delete image");s(e=>e.filter(e=>e.id!==t)),I.toast.success("ì´ë¯¸ì§€ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤")}catch(e){throw console.error("Error deleting image:",e),I.toast.error("ì´ë¯¸ì§€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),e}},[e]),x=(0,r.useCallback)(async t=>{if(e&&0!==t.length)try{if(!(await fetch(`/api/customer/pets/${e}/images`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageIds:t})})).ok)throw Error("Failed to delete images");s(e=>e.filter(e=>!t.includes(e.id))),I.toast.success("ì´ë¯¸ì§€ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤")}catch(e){throw console.error("Error deleting images:",e),I.toast.error("ì´ë¯¸ì§€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),e}},[e]),g=(0,r.useCallback)(async t=>{if(e)try{if(!(await fetch(`/api/customer/pets/${e}/images/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPrimary:!0})})).ok)throw Error("Failed to set primary image");s(e=>e.map(e=>({...e,isPrimary:e.id===t}))),I.toast.success("ëŒ€í‘œ ì´ë¯¸ì§€ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤")}catch(e){throw console.error("Error setting primary image:",e),I.toast.error("ëŒ€í‘œ ì´ë¯¸ì§€ ì„¤ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),e}},[e]),u=(0,r.useCallback)(async(t,s)=>{if(e)try{if(!(await fetch(`/api/customer/pets/${e}/images/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({displayOrder:s})})).ok)throw Error("Failed to reorder image");await d()}catch(e){throw console.error("Error reordering image:",e),I.toast.error("ì´ë¯¸ì§€ ìˆœì„œ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),e}},[e,d]);return{images:t,isLoading:a,isUploading:c,uploadProgress:l,fetchImages:d,uploadImages:m,deleteImage:h,deleteImages:x,setPrimaryImage:g,reorderImages:u}}(n?.id||""),W=async()=>{b(!0);try{let e=await fetch("/api/breeds");if(!e.ok)throw Error("Failed to fetch breeds");let t=await e.json();v(t)}catch(e){console.error("Error fetching breeds:",e),I.toast.error("í’ˆì¢… ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}finally{b(!1)}},K=async e=>{await R(e),o&&o()},_=async e=>{await H(e),o&&o()},J=async e=>{await V(e),o&&o()};(0,r.useEffect)(()=>{if(e&&W(),n&&"edit"===c){let e,t,s,a,r,i,l,c;P({name:n.name,type:n.type,breedId:n.breedId||"",weight:n.weight||void 0,age:n.age||void 0,birthDate:n.birthDate?(t=(e=new Date(n.birthDate)).getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),`${t}-${s}-${a}`):void 0,gender:n.gender||void 0,hairType:n.hairType||void 0,specialNeeds:n.specialNeeds||"",vaccinationStatus:n.vaccinationStatus||"UNKNOWN",vaccinationDate:n.vaccinationDate?(i=(r=new Date(n.vaccinationDate)).getFullYear(),l=String(r.getMonth()+1).padStart(2,"0"),c=String(r.getDate()).padStart(2,"0"),`${i}-${l}-${c}`):void 0,termsAcception:n.termsAcception||!1}),n.id&&G()}else P({name:"",type:"DOG",breedId:"",weight:void 0,age:void 0,birthDate:void 0,gender:void 0,hairType:void 0,specialNeeds:"",vaccinationStatus:"UNKNOWN",vaccinationDate:void 0,termsAcception:!1}),j([]);u({})},[n,c,e,G]);let Y=e=>{let{name:t,value:s}=e.target;"weight"===t||"age"===t?P(e=>({...e,[t]:s?parseFloat(s):void 0})):P(e=>({...e,[t]:s})),g[t]&&u(e=>({...e,[t]:""}))},q=(e,t)=>{P(s=>({...s,[e]:t})),"type"===e&&P(e=>({...e,breedId:"",hairType:"DOG"===t?void 0:e.hairType}))},Q=async()=>{let e;if(e={},z.name||(e.name="ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤"),z.type||(e.type="ì¢…ë¥˜ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤"),z.termsAcception||(e.termsAcception="ì§€ë³‘Â·ë…¸ë ¹ê²¬ ë¯¸ìš© ë™ì˜ì„œì— ë™ì˜í•´ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤"),u(e),0===Object.keys(e).length){m(!0);try{let e={...z,birthDate:z.birthDate?new Date(z.birthDate).toISOString():void 0,vaccinationDate:z.vaccinationDate?new Date(z.vaccinationDate).toISOString():void 0};"create"===c&&p.length>0?await a({...e,images:p}):await a(e),s()}catch(e){console.error("Failed to save pet:",e),I.toast.error("ë°˜ë ¤ë™ë¬¼ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}finally{m(!1)}}};return(0,t.jsx)(F.Dialog,{open:e,onOpenChange:s,children:(0,t.jsxs)(F.DialogContent,{className:"max-h-[90vh] overflow-y-auto sm:max-w-[700px]",children:[(0,t.jsx)(F.DialogHeader,{children:(0,t.jsx)(F.DialogTitle,{children:"create"===c?"ë°˜ë ¤ë™ë¬¼ ë“±ë¡":"ë°˜ë ¤ë™ë¬¼ ì •ë³´ ìˆ˜ì •"})}),(0,t.jsxs)("div",{className:"space-y-6",children:["edit"===c&&n?.id?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"ì‚¬ì§„"}),(0,t.jsxs)("span",{className:"text-muted-foreground text-sm",children:[L.length,"/10 ì‚¬ì§„"]})]}),(0,t.jsx)(B,{images:L,onUpload:K,onDelete:_,onSetPrimary:J,maxImages:10,isUploading:M,className:"pb-4"}),0===L.length&&!U&&(0,t.jsxs)("div",{className:"bg-muted/30 rounded-lg py-6 text-center",children:[(0,t.jsx)(w.Image,{className:"mx-auto mb-3 h-12 w-12 opacity-50"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"ì‚¬ì§„ì„ ì¶”ê°€í•˜ì—¬ ë°˜ë ¤ë™ë¬¼ì„ ì†Œê°œí•´ì£¼ì„¸ìš”"})]})]}):"create"===c&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"ì‚¬ì§„ ì¶”ê°€ (ì„ íƒì‚¬í•­)"}),(0,t.jsxs)("span",{className:"text-muted-foreground text-sm",children:[p.length,"/10 ì‚¬ì§„"]})]}),(0,t.jsxs)("div",{className:"border-border rounded-lg border-2 border-dashed p-6",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{var t;let s,a;e.target.files&&(t=Array.from(e.target.files),s=["image/jpeg","image/jpg","image/png","image/gif","image/webp"],a=t.filter(e=>s.includes(e.type)?!(e.size>0xa00000)||(I.toast.error(`${e.name}: íŒŒì¼ í¬ê¸°ê°€ 10MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤`),!1):(I.toast.error(`${e.name}: ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤`),!1)),p.length+a.length>10?I.toast.error("ìµœëŒ€ 10ê°œì˜ ì´ë¯¸ì§€ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"):j(e=>[...e,...a]))},className:"hidden",id:"image-upload"}),(0,t.jsxs)("label",{htmlFor:"image-upload",className:"flex cursor-pointer flex-col items-center justify-center",children:[(0,t.jsx)(w.Image,{className:"mb-3 h-12 w-12 opacity-50"}),(0,t.jsx)("p",{className:"mb-1 text-sm font-medium",children:"ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”"}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"JPG, PNG, GIF, WebP (ìµœëŒ€ 10MB)"})]})]}),p.length>0&&(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:p.map((e,s)=>(0,t.jsxs)("div",{className:"group relative",children:[(0,t.jsx)(y.default,{src:URL.createObjectURL(e),alt:`Preview ${s+1}`,width:120,height:96,className:"h-24 w-full rounded-lg object-cover"}),(0,t.jsx)("button",{type:"button",onClick:()=>{j(e=>e.filter((e,t)=>t!==s))},className:"bg-destructive text-destructive-foreground absolute top-1 right-1 rounded-full p-1 opacity-0 transition-opacity group-hover:opacity-100",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,t.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},s))})]}),(0,t.jsx)($.Separator,{}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"ê¸°ë³¸ ì •ë³´"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"type",children:"ë°˜ë ¤ë™ë¬¼ ì¢…ë¥˜ *"}),(0,t.jsxs)(A.Select,{value:z.type,onValueChange:e=>q("type",e),children:[(0,t.jsx)(A.SelectTrigger,{children:(0,t.jsx)(A.SelectValue,{placeholder:"ì¢…ë¥˜ ì„ íƒ"})}),(0,t.jsxs)(A.SelectContent,{children:[(0,t.jsx)(A.SelectItem,{value:"DOG",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Dog,{className:"h-4 w-4"}),"ê°•ì•„ì§€"]})}),(0,t.jsx)(A.SelectItem,{value:"CAT",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Cat,{className:"h-4 w-4"}),"ê³ ì–‘ì´"]})})]})]}),g.type&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:g.type})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"name",children:"ì´ë¦„ *"}),(0,t.jsx)(C.Input,{id:"name",name:"name",value:z.name,onChange:Y,placeholder:"ë°˜ë ¤ë™ë¬¼ ì´ë¦„",className:g.name?"border-red-500":""}),g.name&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:g.name})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"breed",children:"í’ˆì¢…"}),N?(0,t.jsx)("div",{className:"flex h-10 items-center justify-center rounded-md border",children:(0,t.jsx)(l.LoadingSpinner,{size:"sm"})}):(0,t.jsxs)(A.Select,{value:z.breedId,onValueChange:e=>q("breedId",e),children:[(0,t.jsx)(A.SelectTrigger,{children:(0,t.jsx)(A.SelectValue,{placeholder:"í’ˆì¢…ì„ ì„ íƒí•˜ì„¸ìš”"})}),(0,t.jsx)(A.SelectContent,{children:f.filter(e=>e.petType===z.type).map(e=>(0,t.jsx)(A.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:["CAT"===z.type&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"hairType",children:"í„¸ íƒ€ì…"}),(0,t.jsxs)(A.Select,{value:z.hairType,onValueChange:e=>q("hairType",e),children:[(0,t.jsx)(A.SelectTrigger,{children:(0,t.jsx)(A.SelectValue,{placeholder:"í„¸ íƒ€ì… ì„ íƒ"})}),(0,t.jsxs)(A.SelectContent,{children:[(0,t.jsx)(A.SelectItem,{value:"SHORT_HAIR",children:"ë‹¨ëª¨"}),(0,t.jsx)(A.SelectItem,{value:"LONG_HAIR",children:"ì¥ëª¨"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"gender",children:"ì„±ë³„"}),(0,t.jsxs)(A.Select,{value:z.gender,onValueChange:e=>q("gender",e),children:[(0,t.jsx)(A.SelectTrigger,{children:(0,t.jsx)(A.SelectValue,{placeholder:"ì„±ë³„ ì„ íƒ"})}),(0,t.jsxs)(A.SelectContent,{children:[(0,t.jsx)(A.SelectItem,{value:"MALE",children:"ë‚¨ì"}),(0,t.jsx)(A.SelectItem,{value:"FEMALE",children:"ì—¬ì"}),(0,t.jsx)(A.SelectItem,{value:"UNKNOWN",children:"ëª¨ë¦„"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"weight",children:"ì²´ì¤‘ (kg)"}),(0,t.jsx)(C.Input,{id:"weight",name:"weight",type:"number",step:"0.1",value:z.weight||"",onChange:Y,placeholder:"ì˜ˆ: 5.5"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"birthDate",children:"ìƒë…„ì›”ì¼"}),(0,t.jsx)(C.Input,{id:"birthDate",name:"birthDate",type:"date",value:z.birthDate||"",onChange:Y})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"vaccinationStatus",children:"ì˜ˆë°©ì ‘ì¢… ìƒíƒœ"}),(0,t.jsxs)(A.Select,{value:z.vaccinationStatus,onValueChange:e=>q("vaccinationStatus",e),children:[(0,t.jsx)(A.SelectTrigger,{children:(0,t.jsx)(A.SelectValue,{placeholder:"ì ‘ì¢… ìƒíƒœ ì„ íƒ"})}),(0,t.jsxs)(A.SelectContent,{children:[(0,t.jsx)(A.SelectItem,{value:"UP_TO_DATE",children:"ì ‘ì¢… ì™„ë£Œ"}),(0,t.jsx)(A.SelectItem,{value:"OVERDUE",children:"ì ‘ì¢… ì§€ì—°"}),(0,t.jsx)(A.SelectItem,{value:"PARTIAL",children:"ë¶€ë¶„ ì ‘ì¢…"}),(0,t.jsx)(A.SelectItem,{value:"UNKNOWN",children:"ë¯¸í™•ì¸"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"vaccinationDate",children:"ìµœê·¼ ì ‘ì¢…ì¼"}),(0,t.jsx)(C.Input,{id:"vaccinationDate",name:"vaccinationDate",type:"date",value:z.vaccinationDate||"",onChange:Y})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.Label,{htmlFor:"specialNeeds",children:"íŠ¹ì´ì‚¬í•­"}),(0,t.jsx)(T.Textarea,{id:"specialNeeds",name:"specialNeeds",value:z.specialNeeds,onChange:Y,placeholder:"ì•Œë ˆë¥´ê¸°, ì§€ë³‘, ì£¼ì˜ì‚¬í•­ ë“±ì„ ì…ë ¥í•´ì£¼ì„¸ìš”",rows:3})]})]}),(0,t.jsx)($.Separator,{}),(0,t.jsxs)("div",{className:"rounded-lg border-2 border-orange-200 bg-orange-50 p-6",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"mb-2 text-lg font-semibold text-orange-900",children:"ì§€ë³‘Â·ë…¸ë ¹ê²¬ ë¯¸ìš© ë™ì˜ì„œ"}),(0,t.jsx)("p",{className:"text-sm text-orange-700",children:"ë°˜ë ¤ë™ë¬¼ì˜ ì•ˆì „í•œ ë¯¸ìš©ì„ ìœ„í•´ ì•„ë˜ ë™ì˜ì„œë¥¼ í™•ì¸í•˜ê³  ë™ì˜í•´ì£¼ì„¸ìš”."})]}),(0,t.jsxs)(i.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>E(!O),className:"mb-4 w-full justify-between border-orange-300 bg-white hover:bg-orange-100",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:O?"ë™ì˜ì„œ ë‚´ìš© ì ‘ê¸°":"ë™ì˜ì„œ ë‚´ìš© ë³´ê¸°"}),O?(0,t.jsx)(D.ChevronUp,{className:"h-4 w-4"}):(0,t.jsx)(S.ChevronDown,{className:"h-4 w-4"})]}),O&&(0,t.jsxs)("div",{className:"mb-4 space-y-4 rounded-lg bg-white p-4 text-sm",children:[(0,t.jsxs)("div",{className:"rounded-lg border-l-4 border-orange-500 bg-orange-50 p-3",children:[(0,t.jsx)("p",{className:"mb-1 font-semibold text-orange-800",children:"â€» ì•ˆë‚´ì‚¬í•­ â€»"}),(0,t.jsx)("p",{className:"text-orange-700",children:'ì§€ë³‘(ë‡Œì§ˆí™˜, ì‹¬ì¥ì§ˆí™˜, ë³´í–‰ë¶ˆê°€ ë“±)ì´ ìˆê±°ë‚˜ ë…¸ë ¹ê²¬(ë§Œ 10ì„¸ ì´ìƒ)ì¸ ê²½ìš° ë°˜ë“œì‹œ "ì§€ë³‘Â·ë…¸ë ¹ê²¬ ë¯¸ìš© ë™ì˜ì„œ"ë¥¼ ì‘ì„±í•´ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.'})]}),(0,t.jsxs)("ol",{className:"list-decimal space-y-3 pl-5 text-gray-700",children:[(0,t.jsx)("li",{children:"ë¯¸ë¯¸ì‚´ë¡±í«ì€ ë°˜ë ¤ê²¬ ë¯¸ìš© ì‹œ ë°˜ë ¤ê²¬ì˜ ê±´ê°•ê³¼ ì•ˆì „ì„ ìµœìš°ì„ ìœ¼ë¡œ ê³ ë ¤í•˜ì—¬ ì†Œí™€í•¨ ì—†ì´ ìµœëŒ€í•œ ì£¼ì˜ë¥¼ ê¸°ìš¸ì—¬ ë¯¸ìš©ì„ ì§„í–‰í•  ê²ƒì„ ì•½ì†ë“œë¦½ë‹ˆë‹¤."}),(0,t.jsx)("li",{children:"ë‹¤ë§Œ, ë…¸ë ¹ê²¬ ë° ì§€ë³‘ì´ ìˆëŠ” ë°˜ë ¤ê²¬ì˜ ê²½ìš° ë…¸í™” ë° ê¸°ì¡´ ì§ˆí™˜ìœ¼ë¡œ ì¸í•œ ê°ì¢… ìœ„í—˜ ìš”ì¸ì´ ì¡´ì¬í•  ìˆ˜ ìˆìœ¼ë©° ë¯¸ìš© í›„ ìƒíƒœ ì•…í™” ë˜ëŠ” ìŠ¤íŠ¸ë ˆìŠ¤ ìœ ë°œë¡œ ì¸í•œ ì›ì¹˜ ì•ŠëŠ” ìƒí™©ì´ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ìˆìŒì„ ì‚¬ì „ ê³ ì§€ë“œë¦½ë‹ˆë‹¤."}),(0,t.jsx)("li",{children:"ë¯¸ë¯¸ì‚´ë¡±í«ì€ ìµœëŒ€í•œ ë³´í˜¸ìì˜ ì…ì¥ì—ì„œ ì•„ì´ë“¤ì˜ ìƒíƒœë¥¼ ì‚´í”¼ë©° ë¯¸ìš©ì„ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ìœ„ì™€ ê°™ì€ ìƒí™©ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ê±´ê°• ì´ìƒ ë° ì‚¬ê³ ì— ëŒ€í•´ ë¯¸ë¯¸ì‚´ë¡±í«ì€ ë²•ì  ì±…ì„ì„ ì§€ì§€ ì•ŠìŒì— ëŒ€í•´ ë³´í˜¸ìì˜ ì‚¬ì „ ë™ì˜ë¥¼ ìš”ì²­ë“œë¦½ë‹ˆë‹¤."}),(0,t.jsx)("li",{children:"ë˜í•œ, ë³¸ ë™ì˜ì„œëŠ” ë¯¸ìš© ì„œë¹„ìŠ¤ ì§„í–‰ ì‹œë§ˆë‹¤ ë§¤ë²ˆ ì‘ì„±í•˜ì‹¤ í•„ìš” ì—†ì´, 1íšŒ ì„œëª…ìœ¼ë¡œ í–¥í›„ ë™ì¼ ì¡°ê±´ í•˜ì— ë™ì¼í•˜ê²Œ ì ìš©ë©ë‹ˆë‹¤."})]})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("input",{type:"checkbox",id:"termsAcception",checked:z.termsAcception,onChange:e=>P(t=>({...t,termsAcception:e.target.checked})),className:"mt-1 h-5 w-5 rounded border-orange-300 text-orange-600 focus:ring-orange-500"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)(k.Label,{htmlFor:"termsAcception",className:"cursor-pointer text-base font-semibold text-orange-900",children:["ìœ„ ë‚´ìš©ì„ í™•ì¸í•˜ì˜€ìœ¼ë©° ì§€ë³‘Â·ë…¸ë ¹ê²¬ ë¯¸ìš© ë™ì˜ì„œì— ë™ì˜í•©ë‹ˆë‹¤"," ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),g.termsAcception&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.termsAcception})]})]})]})]}),(0,t.jsxs)(F.DialogFooter,{children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:s,disabled:d,children:"ì·¨ì†Œ"}),(0,t.jsx)(i.Button,{onClick:Q,disabled:d,children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.LoadingSpinner,{size:"sm",className:"mr-2"}),"ì €ì¥ ì¤‘..."]}):"ì €ì¥"})]})]})})}var M=e.i(418246),G=e.i(107233),R=e.i(711363);function H(){let{data:e,isPending:c}=(0,s.useSession)(),o=(0,a.useRouter)(),{pets:d,isLoading:m,createPet:h,updatePet:x,deletePet:g,fetchPets:u}=(0,M.usePets)(),[p,j]=(0,r.useState)(!1),[f,v]=(0,r.useState)(),[N,y]=(0,r.useState)("create");(0,r.useEffect)(()=>{e||o.push("/auth/signin"),e?.user?.role&&"CUSTOMER"!==e.user.role&&o.push("/dashboard")},[e,o]);let w=()=>{v(void 0),y("create"),j(!0)},S=e=>{v(e),y("edit"),j(!0)},D=async e=>{if("edit"===N&&f)await x(f.id,e),await u();else{let{images:t,...s}=e,a=await h(s);if(t&&t.length>0&&a?.id)try{let e=new FormData;t.forEach(t=>{e.append("files",t)}),(await fetch(`/api/customer/pets/${a.id}/images`,{method:"POST",body:e})).ok?(I.toast.success(`${t.length}ê°œì˜ ì´ë¯¸ì§€ê°€ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤`),await u()):(console.error("Failed to upload images"),I.toast.error("ì´ë¯¸ì§€ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"))}catch(e){console.error("Error uploading images:",e)}}};return c?(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,t.jsx)(l.LoadingSpinner,{size:"lg"})}):e&&e.user?.role==="CUSTOMER"?(0,t.jsxs)("div",{className:"bg-background min-h-screen",children:[(0,t.jsx)("header",{className:"border-border border-b",children:(0,t.jsx)(n.PageHeader,{title:"ë‚´ ë°˜ë ¤ë™ë¬¼",description:"ë°˜ë ¤ë™ë¬¼ ì •ë³´ë¥¼ ê´€ë¦¬í•˜ê³  ì˜ˆì•½ ì‹œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤",children:(0,t.jsxs)(i.Button,{onClick:w,children:[(0,t.jsx)(G.Plus,{className:"mr-2 h-4 w-4"}),"ë°˜ë ¤ë™ë¬¼ ì¶”ê°€"]})})}),(0,t.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[m?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(l.LoadingSpinner,{size:"lg"})}):0===d.length?(0,t.jsx)("div",{className:"mx-auto max-w-md",children:(0,t.jsxs)("div",{className:"border-border rounded-lg border-2 border-dashed p-12 text-center",children:[(0,t.jsx)(R.PawPrint,{className:"text-muted-foreground mx-auto mb-4 h-16 w-16"}),(0,t.jsx)("h2",{className:"mb-2 text-xl font-semibold",children:"ë“±ë¡ëœ ë°˜ë ¤ë™ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-6",children:"ë°˜ë ¤ë™ë¬¼ì„ ë“±ë¡í•˜ê³  ë¯¸ìš© ì„œë¹„ìŠ¤ë¥¼ ì˜ˆì•½í•´ë³´ì„¸ìš”"}),(0,t.jsxs)(i.Button,{onClick:w,size:"lg",children:[(0,t.jsx)(G.Plus,{className:"mr-2 h-5 w-5"}),"ì²« ë°˜ë ¤ë™ë¬¼ ë“±ë¡í•˜ê¸°"]})]})}):(0,t.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:d.map(e=>(0,t.jsx)(b,{pet:e,onEdit:S,onDelete:g},e.id))}),d.length>0&&(0,t.jsxs)("div",{className:"bg-card border-border mt-12 rounded-lg border p-6",children:[(0,t.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:"ë°˜ë ¤ë™ë¬¼ í†µê³„"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"ì´ ë°˜ë ¤ë™ë¬¼"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[d.length,"ë§ˆë¦¬"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"ê°•ì•„ì§€"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[d.filter(e=>"DOG"===e.type).length,"ë§ˆë¦¬"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"ê³ ì–‘ì´"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[d.filter(e=>"CAT"===e.type).length,"ë§ˆë¦¬"]})]})]})]}),(0,t.jsxs)("div",{className:"bg-muted/50 mt-8 rounded-lg p-6",children:[(0,t.jsx)("h3",{className:"mb-3 font-semibold",children:"ğŸ’¡ ì•Œì•„ë‘ì„¸ìš”"}),(0,t.jsxs)("ul",{className:"text-muted-foreground space-y-2 text-sm",children:[(0,t.jsx)("li",{children:"â€¢ ë°˜ë ¤ë™ë¬¼ ì •ë³´ëŠ” ì˜ˆì•½ ì‹œ ë¯¸ìš©ì‚¬ì—ê²Œ ì „ë‹¬ë©ë‹ˆë‹¤"}),(0,t.jsx)("li",{children:"â€¢ ì˜ˆë°©ì ‘ì¢… ì •ë³´ë¥¼ ìµœì‹ ìœ¼ë¡œ ìœ ì§€í•´ì£¼ì„¸ìš”"}),(0,t.jsx)("li",{children:"â€¢ íŠ¹ì´ì‚¬í•­ì€ ë¯¸ìš© ì‹œ ì£¼ì˜ì‚¬í•­ìœ¼ë¡œ í™œìš©ë©ë‹ˆë‹¤"}),(0,t.jsx)("li",{children:"â€¢ ì •í™•í•œ ì²´ì¤‘ ì •ë³´ëŠ” ì„œë¹„ìŠ¤ ìš”ê¸ˆ ì‚°ì •ì— ë„ì›€ì´ ë©ë‹ˆë‹¤"})]})]})]}),(0,t.jsx)(U,{isOpen:p,onClose:()=>{j(!1),v(void 0)},onSave:D,pet:f,mode:N,onImagesUpdated:u})]}):null}e.s(["default",()=>H],948402)}]);