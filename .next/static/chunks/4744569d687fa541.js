(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,869230,e=>{"use strict";var t=e.i(175555),s=e.i(540143),r=e.i(286491),i=e.i(915823),n=e.i(793803),a=e.i(619273),l=e.i(180166),o=class extends i.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#s=(0,n.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#r=void 0;#i=void 0;#n=void 0;#a;#l;#s;#t;#o;#c;#u;#d;#h;#m;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#r.addObserver(this),c(this.#r,this.options)?this.#x():this.updateResult(),this.#f())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return u(this.#r,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return u(this.#r,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#y(),this.#r.removeObserver(this)}setOptions(e){let t=this.options,s=this.#r;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,a.resolveEnabled)(this.options.enabled,this.#r))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#g(),this.#r.setOptions(this.options),t._defaulted&&!(0,a.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#r,observer:this});let r=this.hasListeners();r&&d(this.#r,s,this.options,t)&&this.#x(),this.updateResult(),r&&(this.#r!==s||(0,a.resolveEnabled)(this.options.enabled,this.#r)!==(0,a.resolveEnabled)(t.enabled,this.#r)||(0,a.resolveStaleTime)(this.options.staleTime,this.#r)!==(0,a.resolveStaleTime)(t.staleTime,this.#r))&&this.#j();let i=this.#v();r&&(this.#r!==s||(0,a.resolveEnabled)(this.options.enabled,this.#r)!==(0,a.resolveEnabled)(t.enabled,this.#r)||i!==this.#m)&&this.#N(i)}getOptimisticResult(e){var t,s;let r=this.#e.getQueryCache().build(this.#e,e),i=this.createResult(r,e);return t=this,s=i,(0,a.shallowEqualObjects)(t.getCurrentResult(),s)||(this.#n=i,this.#l=this.options,this.#a=this.#r.state),i}getCurrentResult(){return this.#n}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#s.status||this.#s.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){this.#p.add(e)}getCurrentQuery(){return this.#r}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#x({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#x(e){this.#g();let t=this.#r.fetch(this.options,e);return e?.throwOnError||(t=t.catch(a.noop)),t}#j(){this.#b();let e=(0,a.resolveStaleTime)(this.options.staleTime,this.#r);if(a.isServer||this.#n.isStale||!(0,a.isValidTimeout)(e))return;let t=(0,a.timeUntilStale)(this.#n.dataUpdatedAt,e);this.#d=l.timeoutManager.setTimeout(()=>{this.#n.isStale||this.updateResult()},t+1)}#v(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#r):this.options.refetchInterval)??!1}#N(e){this.#y(),this.#m=e,!a.isServer&&!1!==(0,a.resolveEnabled)(this.options.enabled,this.#r)&&(0,a.isValidTimeout)(this.#m)&&0!==this.#m&&(this.#h=l.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||t.focusManager.isFocused())&&this.#x()},this.#m))}#f(){this.#j(),this.#N(this.#v())}#b(){this.#d&&(l.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#y(){this.#h&&(l.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let s,i=this.#r,l=this.options,o=this.#n,u=this.#a,m=this.#l,p=e!==i?e.state:this.#i,{state:x}=e,f={...x},b=!1;if(t._optimisticResults){let s=this.hasListeners(),n=!s&&c(e,t),a=s&&d(e,i,t,l);(n||a)&&(f={...f,...(0,r.fetchState)(x.data,e.options)}),"isRestoring"===t._optimisticResults&&(f.fetchStatus="idle")}let{error:y,errorUpdatedAt:g,status:j}=f;s=f.data;let v=!1;if(void 0!==t.placeholderData&&void 0===s&&"pending"===j){let e;o?.isPlaceholderData&&t.placeholderData===m?.placeholderData?(e=o.data,v=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#u?.state.data,this.#u):t.placeholderData,void 0!==e&&(j="success",s=(0,a.replaceData)(o?.data,e,t),b=!0)}if(t.select&&void 0!==s&&!v)if(o&&s===u?.data&&t.select===this.#o)s=this.#c;else try{this.#o=t.select,s=t.select(s),s=(0,a.replaceData)(o?.data,s,t),this.#c=s,this.#t=null}catch(e){this.#t=e}this.#t&&(y=this.#t,s=this.#c,g=Date.now(),j="error");let N="fetching"===f.fetchStatus,R="pending"===j,w="error"===j,C=R&&N,S=void 0!==s,T={status:j,fetchStatus:f.fetchStatus,isPending:R,isSuccess:"success"===j,isError:w,isInitialLoading:C,isLoading:C,data:s,dataUpdatedAt:f.dataUpdatedAt,error:y,errorUpdatedAt:g,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>p.dataUpdateCount||f.errorUpdateCount>p.errorUpdateCount,isFetching:N,isRefetching:N&&!R,isLoadingError:w&&!S,isPaused:"paused"===f.fetchStatus,isPlaceholderData:b,isRefetchError:w&&S,isStale:h(e,t),refetch:this.refetch,promise:this.#s,isEnabled:!1!==(0,a.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===T.status?e.reject(T.error):void 0!==T.data&&e.resolve(T.data)},s=()=>{t(this.#s=T.promise=(0,n.pendingThenable)())},r=this.#s;switch(r.status){case"pending":e.queryHash===i.queryHash&&t(r);break;case"fulfilled":("error"===T.status||T.data!==r.value)&&s();break;case"rejected":("error"!==T.status||T.error!==r.reason)&&s()}}return T}updateResult(){let e=this.#n,t=this.createResult(this.#r,this.options);if(this.#a=this.#r.state,this.#l=this.options,void 0!==this.#a.data&&(this.#u=this.#r),(0,a.shallowEqualObjects)(t,e))return;this.#n=t;let s=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#p.size)return!0;let r=new Set(s??this.#p);return this.options.throwOnError&&r.add("error"),Object.keys(this.#n).some(t=>this.#n[t]!==e[t]&&r.has(t))};this.#R({listeners:s()})}#g(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#r)return;let t=this.#r;this.#r=e,this.#i=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#f()}#R(e){s.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#n)}),this.#e.getQueryCache().notify({query:this.#r,type:"observerResultsUpdated"})})}};function c(e,t){return!1!==(0,a.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&u(e,t,t.refetchOnMount)}function u(e,t,s){if(!1!==(0,a.resolveEnabled)(t.enabled,e)&&"static"!==(0,a.resolveStaleTime)(t.staleTime,e)){let r="function"==typeof s?s(e):s;return"always"===r||!1!==r&&h(e,t)}return!1}function d(e,t,s,r){return(e!==t||!1===(0,a.resolveEnabled)(r.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&h(e,s)}function h(e,t){return!1!==(0,a.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,a.resolveStaleTime)(t.staleTime,e))}e.s(["QueryObserver",()=>o])},673664,427001,e=>{"use strict";let t;var s=e.i(271645);e.i(843476);var r=s.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),i=()=>s.useContext(r);e.s(["useQueryErrorResetBoundary",()=>i],673664);var n=e.i(619273),a=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&!t.isReset()&&(e.retryOnMount=!1)},l=e=>{s.useEffect(()=>{e.clearReset()},[e])},o=({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&void 0===e.data||(0,n.shouldThrowError)(s,[e.error,r]));e.s(["ensurePreventErrorBoundaryRetry",()=>a,"getHasError",()=>o,"useClearResetErrorBoundary",()=>l],427001)},381384,e=>{"use strict";var t=e.i(271645),s=t.createContext(!1),r=()=>t.useContext(s);s.Provider,e.s(["useIsRestoring",()=>r])},254440,e=>{"use strict";var t=e=>{if(e.suspense){let t=e=>"static"===e?e:Math.max(e??1e3,1e3),s=e.staleTime;e.staleTime="function"==typeof s?(...e)=>t(s(...e)):t(s),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,1e3))}},s=(e,t)=>e.isLoading&&e.isFetching&&!t,r=(e,t)=>e?.suspense&&t.isPending,i=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});e.s(["ensureSuspenseTimers",()=>t,"fetchOptimistic",()=>i,"shouldSuspend",()=>r,"willFetch",()=>s])},266027,e=>{"use strict";var t=e.i(869230);e.i(247167);var s=e.i(271645),r=e.i(619273),i=e.i(540143),n=e.i(912598),a=e.i(673664),l=e.i(427001),o=e.i(381384),c=e.i(254440);function u(e,u){return function(e,t,u){let d=(0,o.useIsRestoring)(),h=(0,a.useQueryErrorResetBoundary)(),m=(0,n.useQueryClient)(u),p=m.defaultQueryOptions(e);m.getDefaultOptions().queries?._experimental_beforeQuery?.(p),p._optimisticResults=d?"isRestoring":"optimistic",(0,c.ensureSuspenseTimers)(p),(0,l.ensurePreventErrorBoundaryRetry)(p,h),(0,l.useClearResetErrorBoundary)(h);let x=!m.getQueryCache().get(p.queryHash),[f]=s.useState(()=>new t(m,p)),b=f.getOptimisticResult(p),y=!d&&!1!==e.subscribed;if(s.useSyncExternalStore(s.useCallback(e=>{let t=y?f.subscribe(i.notifyManager.batchCalls(e)):r.noop;return f.updateResult(),t},[f,y]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),s.useEffect(()=>{f.setOptions(p)},[p,f]),(0,c.shouldSuspend)(p,b))throw(0,c.fetchOptimistic)(p,f,h);if((0,l.getHasError)({result:b,errorResetBoundary:h,throwOnError:p.throwOnError,query:m.getQueryCache().get(p.queryHash),suspense:p.suspense}))throw b.error;if(m.getDefaultOptions().queries?._experimental_afterQuery?.(p,b),p.experimental_prefetchInRender&&!r.isServer&&(0,c.willFetch)(b,d)){let e=x?(0,c.fetchOptimistic)(p,f,h):m.getQueryCache().get(p.queryHash)?.promise;e?.catch(r.noop).finally(()=>{f.updateResult()})}return p.notifyOnChangeProps?b:f.trackResult(b)}(e,t.QueryObserver,u)}e.s(["useQuery",()=>u],266027)},954616,e=>{"use strict";var t=e.i(271645),s=e.i(114272),r=e.i(540143),i=e.i(915823),n=e.i(619273),a=class extends i.Subscribable{#e;#n=void 0;#w;#C;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#S()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,n.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#w,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,n.hashKey)(t.mutationKey)!==(0,n.hashKey)(this.options.mutationKey)?this.reset():this.#w?.state.status==="pending"&&this.#w.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#w?.removeObserver(this)}onMutationUpdate(e){this.#S(),this.#R(e)}getCurrentResult(){return this.#n}reset(){this.#w?.removeObserver(this),this.#w=void 0,this.#S(),this.#R()}mutate(e,t){return this.#C=t,this.#w?.removeObserver(this),this.#w=this.#e.getMutationCache().build(this.#e,this.options),this.#w.addObserver(this),this.#w.execute(e)}#S(){let e=this.#w?.state??(0,s.getDefaultState)();this.#n={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#R(e){r.notifyManager.batch(()=>{if(this.#C&&this.hasListeners()){let t=this.#n.variables,s=this.#n.context,r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#C.onSuccess?.(e.data,t,s,r),this.#C.onSettled?.(e.data,null,t,s,r)):e?.type==="error"&&(this.#C.onError?.(e.error,t,s,r),this.#C.onSettled?.(void 0,e.error,t,s,r))}this.listeners.forEach(e=>{e(this.#n)})})}},l=e.i(912598);function o(e,s){let i=(0,l.useQueryClient)(s),[o]=t.useState(()=>new a(i,e));t.useEffect(()=>{o.setOptions(e)},[o,e]);let c=t.useSyncExternalStore(t.useCallback(e=>o.subscribe(r.notifyManager.batchCalls(e)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),u=t.useCallback((e,t)=>{o.mutate(e,t).catch(n.noop)},[o]);if(c.error&&(0,n.shouldThrowError)(o.options.throwOnError,[c.error]))throw c.error;return{...c,mutate:u,mutateAsync:c.mutate}}e.s(["useMutation",()=>o],954616)},412012,e=>{"use strict";let t=(0,e.i(475254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["default",()=>t])},629978,e=>{"use strict";var t=e.i(412012);e.s(["ChevronLeftIcon",()=>t.default])},784774,e=>{"use strict";var t=e.i(843476),s=e.i(975157);function r({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative -mx-4 w-full overflow-x-auto px-4 sm:mx-0 sm:px-0",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...r})})}function i({className:e,...r}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",e),...r})}function n({className:e,...r}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...r})}function a({className:e,...r}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...r})}function l({className:e,...r}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}function o({className:e,...r}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}e.s(["Table",()=>r,"TableBody",()=>n,"TableCell",()=>o,"TableHead",()=>l,"TableHeader",()=>i,"TableRow",()=>a])},501661,e=>{"use strict";let t=(0,e.i(475254).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontalIcon",()=>t],501661)},646951,e=>{"use strict";var t=e.i(843476),s=e.i(401851),r=e.i(116550),i=e.i(578938),n=e.i(613846),a=e.i(271645),l=e.i(266027),o=e.i(954616),c=e.i(912598),u=e.i(212426);let d=(0,e.i(475254).default)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var h=e.i(519455),m=e.i(93814),p=e.i(784774),x=e.i(629978),f=e.i(233565),b=e.i(501661),y=e.i(975157);function g({className:e,...s}){return(0,t.jsx)("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:(0,y.cn)("mx-auto flex w-full justify-center",e),...s})}function j({className:e,...s}){return(0,t.jsx)("ul",{"data-slot":"pagination-content",className:(0,y.cn)("flex flex-row items-center gap-1",e),...s})}function v({...e}){return(0,t.jsx)("li",{"data-slot":"pagination-item",...e})}function N({className:e,isActive:s,size:r="icon",...i}){return(0,t.jsx)("a",{"aria-current":s?"page":void 0,"data-slot":"pagination-link","data-active":s,className:(0,y.cn)((0,h.buttonVariants)({variant:s?"outline":"ghost",size:r}),"min-h-[44px] min-w-[44px] sm:min-h-[40px] sm:min-w-[40px]",s&&"border-2 font-bold",e),...i})}function R({className:e,...s}){return(0,t.jsxs)(N,{"aria-label":"Go to previous page",size:"default",className:(0,y.cn)("gap-1 px-3 py-2 font-medium","min-h-[44px] sm:min-h-[40px]",e),...s,children:[(0,t.jsx)(x.ChevronLeftIcon,{className:"h-5 w-5 sm:h-4 sm:w-4"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Previous"})]})}function w({className:e,...s}){return(0,t.jsxs)(N,{"aria-label":"Go to next page",size:"default",className:(0,y.cn)("gap-1 px-3 py-2 font-medium","min-h-[44px] sm:min-h-[40px]",e),...s,children:[(0,t.jsx)("span",{className:"hidden sm:block",children:"Next"}),(0,t.jsx)(f.ChevronRightIcon,{className:"h-5 w-5 sm:h-4 sm:w-4"})]})}function C({className:e,...s}){return(0,t.jsxs)("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:(0,y.cn)("flex items-center justify-center","h-[44px] w-[44px] sm:h-9 sm:w-9",e),...s,children:[(0,t.jsx)(b.MoreHorizontalIcon,{className:"h-5 w-5 sm:h-4 sm:w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"More pages"})]})}var S=e.i(522016);function T(){let{data:e,isPending:x}=(0,i.useSession)(),f=(0,n.useRouter)(),b=(0,c.useQueryClient)(),[y,T]=(0,a.useState)(1),[k,E]=(0,a.useState)(""),[Q,I]=(0,a.useState)("ALL"),[O,M]=(0,a.useState)(""),[A,D]=(0,a.useState)(null),[L,P]=(0,a.useState)(new Set);(0,a.useEffect)(()=>{e||f.push("/auth/signin"),e?.user?.role&&"ADMIN"!==e.user.role&&f.push("/admin/dashboard/overview")},[e,f]);let{data:F,isLoading:U,error:H}=(0,l.useQuery)({queryKey:["settlements",y,k,Q,O],queryFn:async()=>{let e=new URLSearchParams({page:y.toString(),limit:"20",search:k,status:Q,period:O}),t=await fetch(`/api/admin/settlements?${e}`);if(!t.ok)throw Error("Failed to fetch settlements");return t.json()},enabled:e?.user?.role==="ADMIN"}),K=F?.settlements??[],B=F?.totalPages??1,$=F?.totalCount??0;F?.summary;let q=(0,o.useMutation)({mutationFn:async e=>{let t=e.map(e=>fetch(`/api/admin/settlements/${e}/pay`,{method:"PATCH"}));return(await Promise.all(t)).filter(e=>e.ok).length},onSuccess:(e,t)=>{alert(`âœ… ${e}ê±´ì˜ ì •ì‚°ì´ ì§€ê¸‰ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.`),b.invalidateQueries({queryKey:["settlements"]}),P(new Set)},onError:e=>{console.error("Failed to process bulk payment:",e),alert("âŒ ì§€ê¸‰ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}),z=(0,o.useMutation)({mutationFn:async({settlementId:e,action:t})=>{let s=await fetch(`/api/admin/settlements/${e}/${t}`,{method:"PATCH"});if(!s.ok)throw Error(`Failed to ${t} settlement`);return s.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["settlements"]}),D(null)},onError:e=>{console.error("Settlement action failed:",e),alert(`âŒ ${e.message}`)}}),_=(0,o.useMutation)({mutationFn:async e=>{let t=await fetch("/api/admin/settlements/create-weekly",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({weekOffset:e})}),s=await t.json();if(!t.ok)throw Error(s.error||"ì •ì‚° ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");return s},onSuccess:e=>{alert(`âœ… ${e.message}

ðŸ“Š ì •ì‚° ìš”ì•½:
- ì´ ë¯¸ìš©ì‚¬: ${e.summary.totalGroomers}ëª…
- ìƒì„±ëœ ì •ì‚°: ${e.summary.totalCreated}ê±´
- ì´ ì •ì‚°ì•¡: ${e.summary.totalAmount.toLocaleString("ko-KR")}ì›
${e.summary.failed>0?`- ì‹¤íŒ¨: ${e.summary.failed}ê±´`:""}`),b.invalidateQueries({queryKey:["settlements"]})},onError:(e,t,s)=>{alert(`âŒ ${e.message}`)}}),W=e=>(0,s.format)(new Date(e),"yyyy-MM-dd",{locale:r.ko}),G=e=>{if(e.includes("W")){let[t,s]=e.split("-W");return`${t}ë…„ ${s}ì£¼ì°¨`}let[t,s]=e.split("-");return`${t}ë…„ ${s}ì›”`};return x||U?(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,t.jsx)(m.LoadingSpinner,{size:"lg"})}):e&&e.user?.role==="ADMIN"?(0,t.jsxs)("div",{className:"bg-background min-h-screen",children:[(0,t.jsx)("header",{className:"border-border border-b",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,t.jsx)(d,{className:"text-primary h-6 w-6"}),(0,t.jsx)("h1",{className:"text-foreground text-3xl font-bold",children:"ì •ì‚° ê´€ë¦¬"})]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"ìˆ˜ìµê³¼ ë¯¸ìš©ì‚¬ ì •ì‚°ì„ ê´€ë¦¬í•˜ì„¸ìš”"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(h.Button,{onClick:()=>{confirm("ì§€ë‚œì£¼ ì •ì‚°ì„ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì™„ë£Œëœ ì˜ˆì•½ì„ ê¸°ì¤€ìœ¼ë¡œ ë¯¸ìš©ì‚¬ ìˆ˜ìˆ˜ë£Œê°€ ê³„ì‚°ë©ë‹ˆë‹¤.")&&_.mutate(1)},disabled:_.isPending,children:[(0,t.jsx)(d,{className:"mr-2 h-4 w-4"}),"ì£¼ê°„ ì •ì‚° ìƒì„±"]}),(0,t.jsx)(h.Button,{asChild:!0,variant:"outline",children:(0,t.jsx)(S.default,{href:"/admin/dashboard/settlement/grades",children:"ë“±ê¸‰ ì„¤ì •"})}),(0,t.jsxs)("span",{className:"text-muted-foreground text-sm",children:["ì´ ",$.toLocaleString("ko-KR"),"ê±´"]})]})]})})}),(0,t.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[L.size>0&&(0,t.jsxs)("div",{className:"border-border bg-primary/5 mb-4 flex items-center justify-between rounded-lg border p-4",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("span",{className:"text-sm font-medium",children:[L.size,"ê±´ ì„ íƒë¨"]})}),(0,t.jsxs)(h.Button,{onClick:()=>{0===L.size?alert("ì§€ê¸‰í•  ì •ì‚°ì„ ì„ íƒí•´ì£¼ì„¸ìš”."):confirm(`ì„ íƒëœ ${L.size}ê±´ì˜ ì •ì‚°ì„ ì§€ê¸‰ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)&&q.mutate(Array.from(L))},disabled:q.isPending,children:[(0,t.jsx)(u.DollarSign,{className:"mr-2 h-4 w-4"}),"ì§€ê¸‰ì²˜ë¦¬ì™„ë£Œ"]})]}),(0,t.jsxs)("div",{className:"border-border bg-card rounded-lg border",children:[(0,t.jsx)("div",{className:"border-border border-b p-6",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("input",{type:"text",placeholder:"ë¯¸ìš©ì‚¬ëª…, ì´ë©”ì¼ë¡œ ê²€ìƒ‰...",value:k,onChange:e=>E(e.target.value),className:"border-input bg-background focus:ring-ring w-full rounded-md border px-4 py-2 focus:border-transparent focus:ring-2 focus:outline-none"})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("select",{value:Q,onChange:e=>I(e.target.value),className:"border-input bg-background rounded-md border px-3 py-2 text-sm",children:[(0,t.jsx)("option",{value:"ALL",children:"ëª¨ë“  ìƒíƒœ"}),(0,t.jsx)("option",{value:"PENDING",children:"ëŒ€ê¸°ì¤‘"}),(0,t.jsx)("option",{value:"CALCULATED",children:"ê³„ì‚°ë¨"}),(0,t.jsx)("option",{value:"PAID",children:"ì§€ê¸‰ì™„ë£Œ"}),(0,t.jsx)("option",{value:"FAILED",children:"ì‹¤íŒ¨"}),(0,t.jsx)("option",{value:"CANCELLED",children:"ì·¨ì†Œ"})]}),(0,t.jsx)("input",{type:"month",value:O,onChange:e=>M(e.target.value),className:"border-input bg-background rounded-md border px-3 py-2 text-sm"})]})]})}),(0,t.jsxs)(p.Table,{children:[(0,t.jsx)(p.TableHeader,{children:(0,t.jsxs)(p.TableRow,{children:[(0,t.jsx)(p.TableHead,{className:"w-12",children:(0,t.jsx)("input",{type:"checkbox",checked:K.length>0&&L.size===K.length,onChange:()=>{L.size===K.length?P(new Set):P(new Set(K.map(e=>e.id)))},className:"h-4 w-4 rounded border-gray-300"})}),(0,t.jsx)(p.TableHead,{children:"ì •ì‚° ê¸°ê°„"}),(0,t.jsx)(p.TableHead,{children:"ë¯¸ìš©ì‚¬"}),(0,t.jsx)(p.TableHead,{children:"ê³„ì¢Œì •ë³´"}),(0,t.jsx)(p.TableHead,{className:"text-right",children:"ìˆ˜ìˆ˜ë£Œ"}),(0,t.jsx)(p.TableHead,{className:"text-right",children:"ì •ì‚°ê¸ˆì•¡"}),(0,t.jsx)(p.TableHead,{className:"text-center",children:"ì„œë¹„ìŠ¤ ê±´ìˆ˜"})]})}),(0,t.jsx)(p.TableBody,{children:K.map(e=>(0,t.jsxs)(p.TableRow,{children:[(0,t.jsx)(p.TableCell,{children:(0,t.jsx)("input",{type:"checkbox",checked:L.has(e.id),onChange:()=>{var t;let s;return t=e.id,void((s=new Set(L)).has(t)?s.delete(t):s.add(t),P(s))},className:"h-4 w-4 rounded border-gray-300"})}),(0,t.jsx)(p.TableCell,{children:(0,t.jsx)("span",{className:"text-sm font-medium",children:G(e.period)})}),(0,t.jsx)(p.TableCell,{children:(0,t.jsx)("p",{className:"font-medium",children:e.groomer?.name||"ì•Œ ìˆ˜ ì—†ìŒ"})}),(0,t.jsx)(p.TableCell,{children:(0,t.jsx)("div",{className:"text-sm",children:e.groomer?.bankName&&e.groomer?.bankAccountNumber?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"font-medium",children:e.groomer.bankName}),(0,t.jsx)("p",{className:"text-muted-foreground",children:e.groomer.bankAccountNumber})]}):(0,t.jsx)("p",{className:"text-muted-foreground",children:"ê³„ì¢Œ ë¯¸ë“±ë¡"})})}),(0,t.jsx)(p.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("p",{className:"text-muted-foreground",children:[e.groomer?.commissionRate||0,"%"]}),(0,t.jsxs)("p",{className:"font-medium text-red-600",children:[e.commission.toLocaleString("ko-KR"),"ì›"]})]})}),(0,t.jsx)(p.TableCell,{className:"text-right",children:(0,t.jsxs)("p",{className:"text-primary font-bold",children:[e.netAmount.toLocaleString("ko-KR"),"ì›"]})}),(0,t.jsx)(p.TableCell,{className:"text-center",children:(0,t.jsxs)("span",{className:"text-sm font-medium",children:[e.totalBookings,"ê±´"]})})]},e.id))})]}),B>1&&(0,t.jsx)("div",{className:"border-border border-t p-6",children:(0,t.jsx)(g,{children:(0,t.jsxs)(j,{children:[(0,t.jsx)(v,{children:(0,t.jsx)(R,{href:"#",onClick:e=>{e.preventDefault(),T(Math.max(1,y-1))},className:1===y?"pointer-events-none opacity-50":""})}),Array.from({length:B},(e,t)=>t+1).map(e=>1===e||e===B||e>=y-1&&e<=y+1?(0,t.jsx)(v,{children:(0,t.jsx)(N,{href:"#",isActive:e===y,onClick:t=>{t.preventDefault(),T(e)},children:e})},e):e===y-2||e===y+2?(0,t.jsx)(v,{children:(0,t.jsx)(C,{})},e):null),(0,t.jsx)(v,{children:(0,t.jsx)(w,{href:"#",onClick:e=>{e.preventDefault(),T(Math.min(B,y+1))},className:y===B?"pointer-events-none opacity-50":""})})]})})})]})]}),A&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:(0,t.jsxs)("div",{className:"bg-card border-border max-h-[90vh] w-full max-w-4xl overflow-y-auto rounded-lg border",children:[(0,t.jsxs)("div",{className:"border-border flex items-center justify-between border-b p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"ì •ì‚° ìƒì„¸ ì •ë³´"}),(0,t.jsx)(h.Button,{variant:"outline",size:"sm",onClick:()=>D(null),children:"ë‹«ê¸°"})]}),(0,t.jsxs)("div",{className:"space-y-6 p-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"mb-3 font-semibold",children:"ê¸°ë³¸ ì •ë³´"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ë¯¸ìš©ì‚¬:"}),(0,t.jsx)("p",{children:A.groomer?.name||"ì•Œ ìˆ˜ ì—†ìŒ"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ì´ë©”ì¼:"}),(0,t.jsx)("p",{children:A.groomer?.email||"ì•Œ ìˆ˜ ì—†ìŒ"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ì •ì‚° ê¸°ê°„:"}),(0,t.jsx)("p",{children:G(A.period)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ìƒíƒœ:"}),(0,t.jsx)("p",{children:(0,t.jsx)("span",{className:`rounded-full px-2 py-1 text-xs ${(e=>{switch(e){case"PENDING":return"bg-yellow-100 text-yellow-700";case"CALCULATED":return"bg-blue-100 text-blue-700";case"PAID":return"bg-green-100 text-green-700";case"FAILED":return"bg-red-100 text-red-700";case"CANCELLED":return"bg-gray-100 text-gray-700"}})(A.status)}`,children:(e=>{switch(e){case"PENDING":return"ëŒ€ê¸°ì¤‘";case"CALCULATED":return"ê³„ì‚°ë¨";case"PAID":return"ì§€ê¸‰ì™„ë£Œ";case"FAILED":return"ì‹¤íŒ¨";case"CANCELLED":return"ì·¨ì†Œ"}})(A.status)})})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"mb-3 font-semibold",children:"ê³„ì¢Œ ì •ë³´"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ì€í–‰:"}),(0,t.jsx)("p",{children:A.groomer?.bankName||"ë¯¸ë“±ë¡"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ê³„ì¢Œë²ˆí˜¸:"}),(0,t.jsx)("p",{children:A.groomer?.bankAccountNumber||"ë¯¸ë“±ë¡"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ì˜ˆê¸ˆì£¼:"}),(0,t.jsx)("p",{children:A.groomer?.bankAccountHolderName||"ë¯¸ë“±ë¡"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"mb-3 font-semibold",children:"ì •ì‚° ë‚´ì—­"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ì´ ì˜ˆì•½:"}),(0,t.jsxs)("p",{className:"font-medium",children:[A.totalBookings,"ê±´"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ì´ ë§¤ì¶œ:"}),(0,t.jsxs)("p",{className:"font-medium",children:[A.totalRevenue.toLocaleString("ko-KR"),"ì›"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ìˆ˜ìˆ˜ë£Œìœ¨:"}),(0,t.jsxs)("p",{className:"font-medium",children:[A.groomer?.commissionRate||0,"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ìˆ˜ìˆ˜ë£Œ:"}),(0,t.jsxs)("p",{className:"font-medium text-red-600",children:[A.commission.toLocaleString("ko-KR"),"ì›"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"ìµœì¢… ì •ì‚°ì•¡:"}),(0,t.jsxs)("p",{className:"text-primary text-lg font-bold",children:[A.netAmount.toLocaleString("ko-KR"),"ì›"]})]})]})]}),A.bookings&&A.bookings.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"mb-3 font-semibold",children:"í¬í•¨ëœ ì˜ˆì•½"}),(0,t.jsx)("div",{className:"max-h-60 overflow-y-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-border border-b",children:[(0,t.jsx)("th",{className:"p-2 text-left",children:"ì˜ˆì•½ì½”ë“œ"}),(0,t.jsx)("th",{className:"p-2 text-left",children:"ì„œë¹„ìŠ¤"}),(0,t.jsx)("th",{className:"p-2 text-left",children:"ì™„ë£Œì¼"}),(0,t.jsx)("th",{className:"p-2 text-right",children:"ê¸ˆì•¡"})]})}),(0,t.jsx)("tbody",{children:A.bookings.map(e=>(0,t.jsxs)("tr",{className:"border-border border-b",children:[(0,t.jsxs)("td",{className:"p-2",children:["#",e.bookingCode]}),(0,t.jsx)("td",{className:"p-2",children:e.service?.name||"ì•Œ ìˆ˜ ì—†ìŒ"}),(0,t.jsx)("td",{className:"p-2",children:W(e.completedAt)}),(0,t.jsxs)("td",{className:"p-2 text-right font-medium",children:[e.totalAmount.toLocaleString("ko-KR"),"ì›"]})]},e.id))})]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"mb-3 font-semibold",children:"ì²˜ë¦¬ ì´ë ¥"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"ìƒì„±ì¼:"}),(0,t.jsx)("span",{children:W(A.createdAt)})]}),A.calculatedAt&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"ê³„ì‚°ì¼:"}),(0,t.jsx)("span",{children:W(A.calculatedAt)})]}),A.paidAt&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"ì§€ê¸‰ì¼:"}),(0,t.jsx)("span",{children:W(A.paidAt)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"ìµœì¢… ìˆ˜ì •:"}),(0,t.jsx)("span",{children:W(A.updatedAt)})]})]})]}),(0,t.jsxs)("div",{className:"border-border flex gap-2 border-t pt-4",children:["PENDING"===A.status&&(0,t.jsx)(h.Button,{onClick:()=>z.mutate({settlementId:A.id,action:"calculate"}),disabled:z.isPending,children:"ì •ì‚° ê³„ì‚°"}),"CALCULATED"===A.status&&(0,t.jsx)(h.Button,{onClick:()=>z.mutate({settlementId:A.id,action:"pay"}),disabled:z.isPending,children:"ì •ì‚° ì§€ê¸‰"})]})]})]})})]}):null}e.s(["default",()=>T],646951)}]);